<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Bill</title>
    <link rel="stylesheet" href="../css/medical_bill.css">
</head>
<body>
    <div class="medical-bill">
        <!-- Header -->
        <div class="bill-header">
            <div class="facility-info">
                <h1 class="facility-name">{{ supplier_name }}</h1>
                <p class="facility-tagline">Healthcare Services</p>
                <p class="facility-address">{{ supplier_address }}</p>
                <p class="facility-contact">{{ supplier_phone }} | {{ supplier_email }}</p>
            </div>
            <div class="bill-meta">
                <h2 class="bill-type">MEDICAL BILL</h2>
                <p><strong>Invoice Number:</strong> {{ invoice_number }}</p>
                <p><strong>Bill Date:</strong> {{ invoice_date }}</p>
                <p><strong>Due Date:</strong> <span class="due-date">{{ due_date }}</span></p>
            </div>
        </div>

        <!-- Patient Information -->
        <div class="patient-info-section">
            <div class="info-box patient-box">
                <h3>Patient Information</h3>
                <p><strong>Patient ID:</strong> <span class="patient-id">{{ patient_id }}</span></p>
                <p><strong>Name:</strong> {{ buyer_name }}</p>
                <p><strong>Date of Birth:</strong> {{ date_of_birth }}</p>
                <p><strong>Address:</strong> {{ buyer_address }}</p>
                <p><strong>Phone:</strong> {{ buyer_phone }}</p>
            </div>

            <div class="info-box insurance-box">
                <h3>Insurance Information</h3>
                <p><strong>Insurance Provider:</strong> {{ insurance_provider }}</p>
                <p><strong>Policy Number:</strong> {{ policy_number }}</p>
                <p><strong>Group Number:</strong> {{ group_number }}</p>
                <p><strong>Coverage Type:</strong> {{ coverage_type }}</p>
            </div>

            <div class="info-box visit-box">
                <h3>Visit Details</h3>
                <p><strong>Visit Date:</strong> {{ visit_date }}</p>
                <p><strong>Admission Date:</strong> {{ admission_date }}</p>
                <p><strong>Discharge Date:</strong> {{ discharge_date }}</p>
                <p><strong>Provider:</strong> {{ provider_name }}</p>
                <p><strong>Provider NPI:</strong> {{ provider_npi }}</p>
            </div>
        </div>

        <!-- Diagnosis & Procedures -->
        <div class="clinical-info-section">
            <div class="diagnosis-section">
                <h3>Diagnosis</h3>
                <table class="diagnosis-table">
                    <thead>
                        <tr>
                            <th>ICD Code</th>
                            <th>Description</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for diagnosis in diagnoses %}
                        <tr>
                            <td class="diagnosis-code">{{ diagnosis.code }}</td>
                            <td class="diagnosis-description">{{ diagnosis.description }}</td>
                            <td class="diagnosis-type">{{ diagnosis.type }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="procedures-section">
                <h3>Procedures & Services</h3>
                <table class="procedures-table">
                    <thead>
                        <tr>
                            <th>CPT/HCPCS Code</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Provider</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for procedure in procedures %}
                        <tr>
                            <td class="procedure-code">{{ procedure.code }}</td>
                            <td class="procedure-description">{{ procedure.description }}</td>
                            <td class="procedure-date">{{ procedure.date }}</td>
                            <td class="procedure-provider">{{ procedure.provider }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Charges Breakdown -->
        <div class="charges-section">
            <h3>Itemized Charges</h3>
            <table class="charges-table">
                <thead>
                    <tr>
                        <th>Service Code</th>
                        <th>Description</th>
                        <th>Date</th>
                        <th>Qty</th>
                        <th>Unit Charge</th>
                        <th>Total Charge</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Professional Services -->
                    <tr class="category-header">
                        <td colspan="6"><strong>Professional Services</strong></td>
                    </tr>
                    {% for service in professional_services %}
                    <tr>
                        <td class="service-code">{{ service.code }}</td>
                        <td class="service-description">{{ service.description }}</td>
                        <td class="service-date">{{ service.date }}</td>
                        <td class="quantity">{{ service.quantity }}</td>
                        <td class="unit-charge">{{ service.unit_charge }}</td>
                        <td class="total-charge">{{ service.total_charge }}</td>
                    </tr>
                    {% endfor %}

                    <!-- Facility Charges -->
                    <tr class="category-header">
                        <td colspan="6"><strong>Facility Charges</strong></td>
                    </tr>
                    {% for charge in facility_charges %}
                    <tr>
                        <td class="service-code">{{ charge.code }}</td>
                        <td class="service-description">{{ charge.description }}</td>
                        <td class="service-date">{{ charge.date }}</td>
                        <td class="quantity">{{ charge.quantity }}</td>
                        <td class="unit-charge">{{ charge.unit_charge }}</td>
                        <td class="total-charge">{{ charge.total_charge }}</td>
                    </tr>
                    {% endfor %}

                    <!-- Laboratory Services -->
                    {% if laboratory_services %}
                    <tr class="category-header">
                        <td colspan="6"><strong>Laboratory Services</strong></td>
                    </tr>
                    {% for lab in laboratory_services %}
                    <tr>
                        <td class="service-code">{{ lab.code }}</td>
                        <td class="service-description">{{ lab.description }}</td>
                        <td class="service-date">{{ lab.date }}</td>
                        <td class="quantity">{{ lab.quantity }}</td>
                        <td class="unit-charge">{{ lab.unit_charge }}</td>
                        <td class="total-charge">{{ lab.total_charge }}</td>
                    </tr>
                    {% endfor %}
                    {% endif %}

                    <!-- Pharmacy/Medications -->
                    {% if pharmacy_charges %}
                    <tr class="category-header">
                        <td colspan="6"><strong>Pharmacy & Medications</strong></td>
                    </tr>
                    {% for med in pharmacy_charges %}
                    <tr>
                        <td class="service-code">{{ med.code }}</td>
                        <td class="service-description">{{ med.description }}</td>
                        <td class="service-date">{{ med.date }}</td>
                        <td class="quantity">{{ med.quantity }}</td>
                        <td class="unit-charge">{{ med.unit_charge }}</td>
                        <td class="total-charge">{{ med.total_charge }}</td>
                    </tr>
                    {% endfor %}
                    {% endif %}

                    <!-- Imaging/Radiology -->
                    {% if imaging_charges %}
                    <tr class="category-header">
                        <td colspan="6"><strong>Imaging & Radiology</strong></td>
                    </tr>
                    {% for imaging in imaging_charges %}
                    <tr>
                        <td class="service-code">{{ imaging.code }}</td>
                        <td class="service-description">{{ imaging.description }}</td>
                        <td class="service-date">{{ imaging.date }}</td>
                        <td class="quantity">{{ imaging.quantity }}</td>
                        <td class="unit-charge">{{ imaging.unit_charge }}</td>
                        <td class="total-charge">{{ imaging.total_charge }}</td>
                    </tr>
                    {% endfor %}
                    {% endif %}
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="5">Total Charges</td>
                        <td class="subtotal">{{ total_charges }}</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Insurance & Payment Summary -->
        <div class="payment-summary-section">
            <h3>Payment Summary</h3>
            <table class="payment-summary-table">
                <tbody>
                    <tr>
                        <td class="summary-label">Total Charges</td>
                        <td class="summary-value">{{ total_charges }}</td>
                    </tr>
                    <tr class="insurance-row">
                        <td class="summary-label">Insurance Adjustment</td>
                        <td class="summary-value insurance-adjustment">-{{ insurance_adjustment }}</td>
                    </tr>
                    <tr>
                        <td class="summary-label">Insurance Payment</td>
                        <td class="summary-value insurance-payment">-{{ insurance_payment }}</td>
                    </tr>
                    <tr>
                        <td class="summary-label">Patient Discount</td>
                        <td class="summary-value discount">-{{ patient_discount }}</td>
                    </tr>
                    <tr>
                        <td class="summary-label">Previous Payments</td>
                        <td class="summary-value payment-received">-{{ previous_payments }}</td>
                    </tr>
                    <tr class="balance-row">
                        <td class="summary-label"><strong>Patient Responsibility (Balance Due)</strong></td>
                        <td class="summary-value patient-balance"><strong>{{ patient_balance }}</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Explanation of Benefits (EOB) Summary -->
        <div class="eob-section">
            <h3>Explanation of Benefits Summary</h3>
            <div class="eob-grid">
                <div class="eob-item">
                    <span class="eob-label">Allowed Amount</span>
                    <span class="eob-value">{{ allowed_amount }}</span>
                </div>
                <div class="eob-item">
                    <span class="eob-label">Deductible Applied</span>
                    <span class="eob-value">{{ deductible_applied }}</span>
                </div>
                <div class="eob-item">
                    <span class="eob-label">Co-Insurance ({{ coinsurance_rate }}%)</span>
                    <span class="eob-value">{{ coinsurance_amount }}</span>
                </div>
                <div class="eob-item">
                    <span class="eob-label">Co-Pay</span>
                    <span class="eob-value">{{ copay_amount }}</span>
                </div>
            </div>
            <p class="eob-note">
                <strong>Note:</strong> The amounts shown are based on your insurance coverage.
                For questions about your benefits, contact {{ insurance_provider }} at {{ insurance_phone }}.
            </p>
        </div>

        <!-- Payment Options -->
        <div class="payment-section">
            <h3>Payment Options</h3>
            <div class="payment-options">
                <div class="payment-option">
                    <h4>üí≥ Online Payment</h4>
                    <p>Visit: <strong>{{ payment_portal_url }}</strong></p>
                    <p>Account: {{ invoice_number }}</p>
                </div>
                <div class="payment-option">
                    <h4>üìû Phone Payment</h4>
                    <p>Call: <strong>{{ billing_phone }}</strong></p>
                    <p>Have your invoice number ready</p>
                </div>
                <div class="payment-option">
                    <h4>‚úâÔ∏è Mail Payment</h4>
                    <p><strong>{{ supplier_name }}</strong></p>
                    <p>{{ billing_address }}</p>
                    <p>Include invoice number on check</p>
                </div>
            </div>
            <div class="payment-plan-info">
                <h4>üí∞ Payment Plans Available</h4>
                <p>Need help paying your bill? We offer flexible payment plans. Contact our billing department
                   at {{ billing_phone }} to discuss your options.</p>
            </div>
        </div>

        <!-- Important Notices -->
        <div class="notices-section">
            <div class="notice-box billing-notice">
                <h4>‚ö† Billing Questions?</h4>
                <p>If you have questions about this bill or believe there is an error, please contact our
                   billing department at {{ billing_phone }} or email {{ billing_email }} within 30 days.</p>
            </div>
            <div class="notice-box rights-notice">
                <h4>üìã Your Rights</h4>
                <p>You have the right to receive an itemized bill and an explanation of services. Financial
                   assistance may be available for qualifying patients.</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="bill-footer">
            <div class="footer-contact">
                <p><strong>Billing Department:</strong> {{ billing_phone }} | {{ billing_email }}</p>
                <p><strong>Business Hours:</strong> Monday-Friday, 8:00 AM - 5:00 PM</p>
            </div>
            <div class="footer-legal">
                <p class="terms-conditions">{{ terms_conditions }}</p>
                <p class="hipaa-notice"><strong>Privacy Notice:</strong> Your health information is protected under HIPAA regulations.</p>
            </div>
        </div>
    </div>
</body>
</html>

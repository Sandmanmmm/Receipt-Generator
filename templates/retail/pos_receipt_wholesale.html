<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wholesale Receipt{% if _page_number|default(none) %} - Page {{ _page_number }} of {{ _total_pages }}{% endif %}</title>
    <link rel="stylesheet" href="../css/pos_receipt_wholesale.css">
</head>
<body>
    <div class="wholesale-receipt">
        <!-- Header -->
        <div class="receipt-header">
            <div class="store-name">{{ store_name }}</div>
            <div class="store-type">WHOLESALE CLUB</div>
            <div class="member-services">Member Services & Business Center</div>
            <div class="store-address">{{ store_address }}</div>
            <div class="store-location">{{ city }}, {{ state }} {{ zip_code }}</div>
            <div class="store-contact">
                <span>{{ phone }}</span> â€¢ <span>{{ website }}</span>
            </div>
        </div>

        <!-- Member Information Banner -->
        {% if member_id|default(none) or member_name|default(none) %}
        <div class="member-banner">
            {% if member_id|default(none) %}
            <div class="member-info-section">
                <div class="member-label">MEMBER #</div>
                <div class="member-number">{{ member_id }}</div>
            </div>
            {% endif %}
            {% if member_name|default(none) %}
            <div class="member-info-section">
                <div class="member-label">MEMBER NAME</div>
                <div class="member-name">{{ member_name }}</div>
            </div>
            {% endif %}
            {% if member_tier|default(none) %}
            <div class="member-tier-badge {{ member_tier|lower }}">
                {{ member_tier }} MEMBER
            </div>
            {% endif %}
        </div>
        {% endif %}

        <!-- Business Account Info (if applicable) -->
        {% if business_account|default(false) %}
        <div class="business-account-section">
            <div class="business-header">
                <span class="business-icon"></span>
                <span class="business-title">BUSINESS ACCOUNT</span>
            </div>
            <div class="business-details">
                <div class="business-row">
                    <span class="business-label">Company:</span>
                    <span class="business-value">{{ company_name }}</span>
                </div>
                <div class="business-row">
                    <span class="business-label">Tax ID:</span>
                    <span class="business-value">{{ tax_id }}</span>
                </div>
                <div class="business-row">
                    <span class="business-label">Resale Cert:</span>
                    <span class="business-value">{{ resale_certificate }}</span>
                </div>
                <div class="business-row">
                    <span class="business-label">Account #:</span>
                    <span class="business-value">{{ account_number }}</span>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Transaction Info -->
        <div class="transaction-info">
            <div class="info-row">
                <span class="info-label">Receipt #:</span>
                <span class="info-value">{{ receipt_number }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Date:</span>
                <span class="info-value">{{ transaction_date }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Time:</span>
                <span class="info-value">{{ transaction_time }}</span>
            </div>
            <div class="info-row">
                <span class="info-label">Cashier:</span>
                <span class="info-value">{{ cashier_name }} ({{ cashier_id }})</span>
            </div>
            <div class="info-row">
                <span class="info-label">Register:</span>
                <span class="info-value">{{ register_number }}</span>
            </div>
            {% if warehouse_location|default(none) %}
            <div class="info-row">
                <span class="info-label">Warehouse:</span>
                <span class="info-value">{{ warehouse_location }}</span>
            </div>
            {% endif %}
        </div>

        <div class="section-divider"></div>

        <!-- Items Section -->
        <div class="items-section">
            <div class="items-header">ITEMS PURCHASED</div>
            
            {% for item in items %}
            <div class="item-block">
                <!-- Item Header -->
                <div class="item-header-row">
                    <div class="item-name">{{ item.name }}</div>
                    <div class="item-total-price">{{ item.total_price }}</div>
                </div>
                
                <!-- Item Details Row -->
                <div class="item-details-row">
                    <div class="item-sku">SKU: {{ item.sku|default('N/A') }}</div>
                    {% if item.brand|default(none) %}
                    <div class="item-brand">{{ item.brand }}</div>
                    {% endif %}
                </div>

                <!-- Bulk Quantity Display -->
                <div class="bulk-quantity-row">
                    {% if item.case_quantity|default(0)|int > 0 %}
                    <div class="case-info">
                        <span class="quantity-icon"></span>
                        <span class="quantity-text">{{ item.case_quantity }} CASE{{ 's' if item.case_quantity > 1 else '' }}</span>
                        <span class="case-detail">({{ item.units_per_case|default(1) }} units/case)</span>
                    </div>
                    {% endif %}
                    
                    {% if item.pallet_quantity|default(0)|int > 0 %}
                    <div class="pallet-info">
                        <span class="quantity-icon">ðŸš›</span>
                        <span class="quantity-text">{{ item.pallet_quantity }} PALLET{{ 's' if item.pallet_quantity > 1 else '' }}</span>
                        <span class="pallet-detail">({{ item.cases_per_pallet|default(1) }} cases/pallet)</span>
                    </div>
                    {% endif %}

                    {% if not (item.case_quantity|default(0)|int > 0) and not (item.pallet_quantity|default(0)|int > 0) %}
                    <div class="unit-info">
                        <span class="quantity-text">{{ item.quantity|default(1) }} UNIT{{ 's' if item.quantity|default(1) > 1 else '' }}</span>
                    </div>
                    {% endif %}
                </div>

                <!-- Pricing Breakdown -->
                <div class="pricing-row">
                    <div class="unit-price">
                        {% if item.case_quantity|default(0)|int > 0 %}
                        <span class="price-label">Price/Case:</span>
                        <span class="price-value">{{ item.price_per_case|default(item.unit_price|default(0)) }}</span>
                        {% elif item.pallet_quantity|default(0)|int > 0 %}
                        <span class="price-label">Price/Pallet:</span>
                        <span class="price-value">{{ item.price_per_pallet|default(item.unit_price|default(0)) }}</span>
                        {% else %}
                        <span class="price-label">Price/Unit:</span>
                        <span class="price-value">{{ item.unit_price|default(0) }}</span>
                        {% endif %}
                    </div>
                    
                    {% if item.tiered_discount|default(0)|int > 0 %}
                    <div class="tiered-savings">
                        <span class="savings-icon"></span>
                        <span class="savings-text">Tiered Discount: -{{ item.tiered_discount }}</span>
                    </div>
                    {% endif %}
                </div>

                <!-- Member Savings (if applicable) -->
                {% if item.member_discount|default(0)|float > 0 %}
                <div class="member-savings-row">
                    <span class="savings-badge">MEMBER SAVINGS</span>
                    <span class="savings-amount">-{{ item.member_discount }}</span>
                </div>
                {% endif %}

                <!-- Weight/Measurement Info -->
                {% if item.weight|default(0)|float > 0 %}
                <div class="weight-info">
                    <span class="weight-label">Total Weight:</span>
                    <span class="weight-value">{{ item.weight }} {{ item.weight_unit|default('lbs') }}</span>
                </div>
                {% endif %}

                <!-- Returnable Deposit -->
                {% if item.deposit|default(0)|float > 0 %}
                <div class="deposit-info">
                    <span class="deposit-label">Container Deposit:</span>
                    <span class="deposit-value">{{ item.deposit }}</span>
                </div>
                {% endif %}

                <!-- Expiration Date (for perishables) -->
                {% if item.expiration_date|default(none) %}
                <div class="expiry-info">
                    <span class="expiry-icon"></span>
                    <span class="expiry-text">Best By: {{ item.expiration_date }}</span>
                </div>
                {% endif %}

                <!-- Country of Origin -->
                {% if item.country_of_origin|default(none) %}
                <div class="origin-info">
                    <span class="origin-label">Origin:</span>
                    <span class="origin-value">{{ item.country_of_origin }}</span>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        {% if _is_last_page|default(true) %}
        <div class="section-divider"></div>

        <!-- Subtotals and Discounts (Last Page Only) -->
        <div class="totals-section">
            <div class="total-row">
                <span class="total-label">SUBTOTAL</span>
                <span class="total-value">{{ subtotal }}</span>
            </div>

            {% if member_total_savings|default(0)|float > 0 %}
            <div class="total-row savings-row">
                <span class="total-label">MEMBER SAVINGS</span>
                <span class="total-value">-{{ member_total_savings }}</span>
            </div>
            {% endif %}

            {% if bulk_discount|default(0)|float > 0 %}
            <div class="total-row savings-row">
                <span class="total-label">BULK DISCOUNT</span>
                <span class="total-value">-{{ bulk_discount }}</span>
            </div>
            {% endif %}

            {% if coupon_savings|default(0)|float > 0 %}
            <div class="total-row savings-row">
                <span class="total-label">COUPON SAVINGS</span>
                <span class="total-value">-{{ coupon_savings }}</span>
            </div>
            {% endif %}

            {% if tax_exempt|default(false) %}
            <div class="total-row tax-exempt-row">
                <span class="total-label">SALES TAX (EXEMPT)</span>
                <span class="total-value">$0.00</span>
            </div>
            <div class="tax-exempt-notice">
                Tax Exempt - Resale Certificate: {{ resale_certificate|default('N/A') }}
            </div>
            {% else %}
            <div class="total-row">
                <span class="total-label">SALES TAX ({{ tax_rate|default(0) }}%)</span>
                <span class="total-value">{{ sales_tax|default('$0.00') }}</span>
            </div>
            {% endif %}

            {% if bottle_deposit|default(0)|float > 0 %}
            <div class="total-row">
                <span class="total-label">BOTTLE DEPOSIT</span>
                <span class="total-value">{{ bottle_deposit }}</span>
            </div>
            {% endif %}

            {% if delivery_fee|default(0)|float > 0 %}
            <div class="total-row">
                <span class="total-label">DELIVERY FEE</span>
                <span class="total-value">{{ delivery_fee }}</span>
            </div>
            {% endif %}

            <div class="section-divider-thin"></div>

            <div class="total-row grand-total">
                <span class="total-label">TOTAL</span>
                <span class="total-value">{{ total_amount }}</span>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- Payment Information -->
        <div class="payment-section">
            <div class="payment-header">PAYMENT INFORMATION</div>
            
            <div class="payment-row">
                <span class="payment-label">{{ payment_method }}</span>
                <span class="payment-value">{{ total_amount }}</span>
            </div>

            {% if card_type|default(none) %}
            <div class="payment-details">
                <div class="card-info">{{ card_type }} ending in {{ card_last_four }}</div>
                {% if approval_code|default(none) %}
                <div class="approval-info">Approval: {{ approval_code }}</div>
                {% endif %}
            </div>
            {% endif %}

            {% if change_due|default(0)|float > 0 %}
            <div class="payment-row">
                <span class="payment-label">CHANGE DUE</span>
                <span class="payment-value">{{ change_due }}</span>
            </div>
            {% endif %}
        </div>

        <!-- Rewards/Cash Back Section -->
        {% if rewards_earned|default(0)|float > 0 or cashback_earned|default(0)|float > 0 %}
        <div class="rewards-section">
            <div class="rewards-header">REWARDS & CASH BACK</div>
            
            {% if rewards_earned|default(0)|float > 0 %}
            <div class="rewards-row">
                <span class="rewards-label">* Points Earned:</span>
                <span class="rewards-value">{{ rewards_earned }} points</span>
            </div>
            {% endif %}

            {% if cashback_earned|default(0)|float > 0 %}
            <div class="rewards-row">
                <span class="rewards-label"> Cash Back Earned:</span>
                <span class="rewards-value">{{ cashback_earned }}</span>
            </div>
            {% endif %}

            {% if rewards_balance|default(0)|float > 0 %}
            <div class="rewards-row balance">
                <span class="rewards-label">Total Points Balance:</span>
                <span class="rewards-value">{{ rewards_balance }} points</span>
            </div>
            {% endif %}

            {% if cashback_balance|default(0)|float > 0 %}
            <div class="rewards-row balance">
                <span class="rewards-label">Total Cash Back:</span>
                <span class="rewards-value">{{ cashback_balance }}</span>
            </div>
            {% endif %}
        </div>
        {% endif %}
        {% endif %}
        <!-- End of _is_last_page totals/payment/rewards section -->

        <!-- Total Savings Summary -->
        {% if _is_last_page|default(true) and total_savings|default(0)|float > 0 %}
        <div class="savings-summary">
            <div class="savings-summary-header">
                TODAY'S TOTAL SAVINGS
            </div>
            <div class="savings-summary-amount">
                {{ total_savings }}
            </div>
            <div class="savings-summary-text">
                You saved {{ savings_percentage|default(0) }}% with your membership!
            </div>
        </div>
        {% endif %}

        <div class="section-divider"></div>

        {% if _is_last_page|default(true) %}
        <!-- Return Policy (Last Page Only) -->
        <div class="policy-section">
            <div class="policy-title">RETURN POLICY</div>
            <div class="policy-text">
                Most items can be returned within {{ return_days|default(90) }} days with receipt.
                Electronics and special orders: {{ electronics_return_days|default(30) }} days.
                Perishable items must be returned same day.
            </div>
            {% if business_account|default(false) %}
            <div class="policy-text">
                Business accounts: Contact your account manager for returns.
            </div>
            {% endif %}
        </div>

        <!-- Member Benefits -->
        <div class="benefits-section">
            <div class="benefits-title">MEMBER BENEFITS</div>
            <div class="benefits-text">
                â€¢ Exclusive wholesale pricing on bulk purchases<br>
                â€¢ Early access to special promotions<br>
                â€¢ Extended return periods for members<br>
                â€¢ Free business delivery on orders over {{ free_delivery_minimum|default('$500') }}<br>
                â€¢ Member-only fuel discount at our gas stations
            </div>
        </div>

        <!-- Contact Information -->
        <div class="contact-section">
            <div class="contact-title">QUESTIONS?</div>
            <div class="contact-text">
                Member Services: {{ customer_service_phone|default(phone) }}<br>
                Business Center: {{ business_center_phone|default(phone) }}<br>
                Online: {{ website|default('www.wholesaleclub.com') }}
            </div>
        </div>

        <!-- Barcode -->
        <div class="barcode-section">
            <div class="barcode-image">|||||||||||||||||||||||||||||||</div>
            <div class="barcode-number">{{ receipt_number }}</div>
        </div>

        <!-- Footer Message -->
        <div class="footer-message">
            THANK YOU FOR YOUR MEMBERSHIP!<br>
            Visit us again soon for more wholesale savings!
        </div>

        <!-- Survey/Feedback -->
        {% if survey_code|default(none) %}
        <div class="survey-section">
            <div class="survey-text">TAKE OUR SURVEY</div>
            <div class="survey-url">{{ survey_url }}</div>
            <div class="survey-code">Survey Code: {{ survey_code }}</div>
            <div class="survey-incentive">Complete within 7 days to receive {{ survey_reward }}</div>
        </div>
        {% endif %}
        {% else %}
        <!-- Continuation footer for non-last pages -->
        <div class="page-continuation">
            <div class="continuation-text">--- Continued on next page ---</div>
            <div class="page-indicator">Page {{ _page_number }} of {{ _total_pages }}</div>
        </div>
        {% endif %}
    </div>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ supplier_name|default('SHINE') }} Invoice</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            font-size: 11px;
            line-height: 1.4;
            color: #333;
            background: #fff;
        }
        
        .invoice-page {
            width: 816px;
            min-height: 1056px;
            padding: 40px 50px;
            background: #fff;
        }
        
        /* Header Section */
        .header {
            display: table;
            width: 100%;
            margin-bottom: 25px;
        }
        
        .header-left {
            display: table-cell;
            width: 50%;
            vertical-align: top;
        }
        
        .header-right {
            display: table-cell;
            width: 50%;
            vertical-align: top;
            text-align: right;
        }
        
        .platform-logo {
            font-size: 42px;
            font-weight: 900;
            letter-spacing: 3px;
            color: #000;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        .company-info {
            font-size: 10px;
            color: #333;
            line-height: 1.5;
        }
        
        .company-name-header {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .company-address {
            color: #555;
        }
        
        .company-reg-row {
            display: table;
            width: 100%;
            margin-top: 3px;
        }
        
        .company-reg {
            display: table-cell;
            color: #555;
        }
        
        .company-website {
            display: table-cell;
            text-align: right;
            color: #555;
        }
        
        /* Invoice Title Section */
        .invoice-title-section {
            display: table;
            width: 100%;
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 15px;
        }
        
        .invoice-title-left {
            display: table-cell;
            width: 35%;
            vertical-align: top;
        }
        
        .invoice-title {
            font-size: 28px;
            font-weight: 400;
            color: #3d8b8b;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .invoice-details {
            font-size: 10px;
            color: #666;
        }
        
        .invoice-number,
        .invoice-date {
            margin-bottom: 2px;
        }
        
        .customer-info-box {
            display: table-cell;
            width: 65%;
            vertical-align: top;
            padding-left: 40px;
        }
        
        .customer-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }
        
        .customer-table td {
            padding: 2px 0;
            vertical-align: top;
        }
        
        .customer-label {
            width: 110px;
            color: #666;
            text-align: left;
        }
        
        .customer-value {
            color: #3d8b8b;
            font-weight: 500;
        }
        
        /* Items Table */
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .items-table thead {
            background: #f5f5f5;
        }
        
        .items-table th {
            padding: 10px 8px;
            text-align: left;
            font-size: 10px;
            font-weight: 600;
            color: #333;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .items-table th.col-product {
            width: 45%;
        }
        
        .items-table th.col-price,
        .items-table th.col-qty,
        .items-table th.col-amount {
            text-align: center;
            width: 18%;
        }
        
        .items-table tbody tr {
            border-bottom: 1px solid #f0f0f0;
        }
        
        .items-table td {
            padding: 12px 8px;
            vertical-align: middle;
            font-size: 10px;
        }
        
        .item-cell {
            display: table;
            width: 100%;
        }
        
        .item-image-wrapper {
            display: table-cell;
            width: 55px;
            vertical-align: top;
        }
        
        .item-image {
            width: 50px;
            height: 65px;
            object-fit: cover;
            border: 1px solid #eee;
        }
        
        .item-image-placeholder {
            width: 50px;
            height: 65px;
            background: #f5f5f5;
            border: 1px solid #eee;
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }
        
        .item-details {
            display: table-cell;
            vertical-align: top;
            padding-left: 10px;
        }
        
        .item-name {
            font-size: 10px;
            color: #333;
            line-height: 1.4;
            margin-bottom: 4px;
        }
        
        .item-variant {
            font-size: 9px;
            color: #888;
        }
        
        .items-table td.col-price,
        .items-table td.col-qty,
        .items-table td.col-amount {
            text-align: center;
        }
        
        /* Totals Section */
        .totals-section {
            display: table;
            width: 100%;
            margin-bottom: 25px;
        }
        
        .totals-spacer {
            display: table-cell;
            width: 55%;
        }
        
        .totals-box {
            display: table-cell;
            width: 45%;
        }
        
        .totals-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }
        
        .totals-table tr td {
            padding: 4px 0;
        }
        
        .totals-table .label {
            text-align: right;
            color: #666;
            padding-right: 15px;
        }
        
        .totals-table .value {
            text-align: right;
            width: 100px;
        }
        
        .totals-table .retail-price .value {
            text-decoration: line-through;
            color: #999;
        }
        
        .totals-table .discount .value,
        .totals-table .points .value {
            color: #cc0000;
        }
        
        .totals-table .grand-total {
            border-top: 1px solid #e0e0e0;
            margin-top: 5px;
        }
        
        .totals-table .grand-total td {
            padding-top: 10px;
            font-weight: 700;
            font-size: 12px;
        }
        
        /* Footer Section */
        .footer-section {
            display: table;
            width: 100%;
            margin-top: 30px;
        }
        
        .footer-left,
        .footer-right {
            display: table-cell;
            width: 50%;
            vertical-align: top;
        }
        
        .footer-block {
            margin-bottom: 15px;
        }
        
        .footer-title {
            font-size: 11px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        
        .footer-content {
            font-size: 10px;
            color: #666;
            line-height: 1.5;
        }
        
        /* Continuation Header */
        .continuation-header {
            display: table;
            width: 100%;
            padding: 10px 0 15px 0;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 15px;
        }
        
        .cont-logo {
            display: table-cell;
            font-size: 24px;
            font-weight: 900;
            letter-spacing: 2px;
            color: #000;
        }
        
        .cont-info {
            display: table-cell;
            text-align: right;
            font-size: 10px;
            color: #666;
            vertical-align: middle;
        }
        
        /* Page Number */
        .page-number {
            text-align: center;
            font-size: 9px;
            color: #999;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="invoice-page">
        {% if _is_first_page|default(true) %}
        <!-- Main Header -->
        <div class="header">
            <div class="header-left">
                <div class="platform-logo">{{ platform_name|default('SHINE') }}</div>
            </div>
            <div class="header-right">
                <div class="company-info">
                    <div class="company-name-header">{{ supplier_name|default('ZoeTop Business Co., Limited') }}</div>
                    <div class="company-address">{{ supplier_address|default('Room. 19C, Lockhart Ctr 301-307 Lockhart Rd') }}</div>
                    <div class="company-address">{{ supplier_city|default('Wan Chai, Wan Chai District 511000') }}</div>
                    <div class="company-address">{{ supplier_country|default('Hong Kong') }}</div>
                    <div class="company-reg-row">
                        <span class="company-reg">Company Number {{ supplier_reg_number|default('2317029') }}</span>
                        <span class="company-website">{{ supplier_website|default('www.shein.com') }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Invoice Title and Customer Info -->
        <div class="invoice-title-section">
            <div class="invoice-title-left">
                <div class="invoice-title">INVOICE</div>
                <div class="invoice-details">
                    <div class="invoice-number">Number: {{ invoice_number|default('GSHMV001000WW4') }}</div>
                    <div class="invoice-date">Date: {{ invoice_date|default('2020-03-29') }}</div>
                </div>
            </div>
            <div class="customer-info-box">
                <table class="customer-table">
                    <tr>
                        <td class="customer-label">Company name:</td>
                        <td class="customer-value">{{ buyer_name|default(customer_name)|default('MY COMPANY NAME') }}</td>
                    </tr>
                    <tr>
                        <td class="customer-label">Contact name:</td>
                        <td class="customer-value">{{ buyer_contact|default(customer_contact)|default('MY CONTACT NAME') }}</td>
                    </tr>
                    <tr>
                        <td class="customer-label">Address:</td>
                        <td class="customer-value">{{ buyer_address|default(customer_address)|default('MY ADDRESS') }}</td>
                    </tr>
                    <tr>
                        <td class="customer-label"></td>
                        <td class="customer-value">{{ buyer_city|default(customer_city)|default('MY CITY, STATE, COUNTRY & ZIP') }}</td>
                    </tr>
                    <tr>
                        <td class="customer-label">Reg. number:</td>
                        <td class="customer-value">{{ buyer_reg_number|default(customer_reg_number)|default('MY REGISTRATION NUMBER') }}</td>
                    </tr>
                </table>
            </div>
        </div>
        {% else %}
        <!-- Continuation Header for multipage -->
        <div class="continuation-header">
            <div class="cont-logo">{{ platform_name|default('SHINE') }}</div>
            <div class="cont-info">Invoice {{ invoice_number }} â€” Page {{ _current_page|default(_page_number) }} of {{ _total_pages }}</div>
        </div>
        {% endif %}

        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-product">Products</th>
                    <th class="col-price">Unit Price</th>
                    <th class="col-qty">Quantity</th>
                    <th class="col-amount">Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items|default(line_items) %}
                <tr>
                    <td class="col-product">
                        <div class="item-cell">
                            <div class="item-image-wrapper">
                                {% if item.image_url %}
                                <img src="{{ item.image_url }}" alt="{{ item.name }}" class="item-image" />
                                {% else %}
                                <div class="item-image-placeholder">ðŸ“·</div>
                                {% endif %}
                            </div>
                            <div class="item-details">
                                <div class="item-name">{{ item.brand|default('') }}{% if item.brand %} {% endif %}{{ item.name|default(item.description) }}</div>
                                {% if item.size or item.color or item.variant %}
                                <div class="item-variant">
                                    {% if item.size %}Size: {{ item.size }}{% endif %}
                                    {% if item.color %}{% if item.size %}, {% endif %}Color: {{ item.color }}{% endif %}
                                    {% if item.variant and not item.size and not item.color %}{{ item.variant }}{% endif %}
                                </div>
                                {% endif %}
                                {% if item.sku or item.model_number %}
                                <div class="item-variant">SKU: {{ item.sku|default(item.model_number) }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </td>
                    <td class="col-price">{{ currency_symbol|default('US$') }}{{ '%.2f'|format(item.unit_price|default(item.price)|to_float) }}</td>
                    <td class="col-qty">{{ item.quantity }}</td>
                    <td class="col-amount">{{ currency_symbol|default('US$') }}{{ '%.2f'|format((item.amount|default(item.total)|default(item.unit_price|to_float * item.quantity))|to_float) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if _is_last_page|default(true) %}
        <!-- Totals Section -->
        <div class="totals-section">
            <div class="totals-spacer"></div>
            <div class="totals-box">
                <table class="totals-table">
                    {% if retail_price or original_total %}
                    <tr class="retail-price">
                        <td class="label">Retail Price:</td>
                        <td class="value">{{ currency_symbol|default('US$') }}{{ '%.2f'|format(retail_price|float) }}</td>
                    </tr>
                    {% endif %}
                    <tr>
                        <td class="label">Sub Total:</td>
                        <td class="value">{{ currency_symbol|default('US$') }}{{ '%.2f'|format(subtotal_raw|default(subtotal)|float) }}</td>
                    </tr>
                    <tr>
                        <td class="label">Shipping fee:</td>
                        <td class="value">{{ currency_symbol|default('US$') }}{{ '%.2f'|format(shipping_fee|default(shipping)|default(0)|float) }}</td>
                    </tr>
                    {% if shipping_guarantee %}
                    <tr>
                        <td class="label">Shipping Guarantee:</td>
                        <td class="value">{{ currency_symbol|default('US$') }}{{ '%.2f'|format(shipping_guarantee|float) }}</td>
                    </tr>
                    {% endif %}
                    {% if discount_amount|default(discount)|default(0)|float > 0 %}
                    <tr class="discount">
                        <td class="label">Discount:</td>
                        <td class="value">-{{ currency_symbol|default('US$') }}{{ '%.2f'|format(discount_amount|default(discount)|float) }}</td>
                    </tr>
                    {% endif %}
                    {% if loyalty_points or shein_points or rewards_points %}
                    <tr class="points">
                        <td class="label">{{ loyalty_program_name|default('Shine Point') }}:</td>
                        <td class="value">-{{ currency_symbol|default('US$') }}{{ '%.2f'|format(loyalty_points|default(shein_points)|default(rewards_points)|float) }}</td>
                    </tr>
                    {% endif %}
                    <tr class="grand-total">
                        <td class="label">Total:</td>
                        <td class="value">{{ currency_symbol|default('US$') }}{{ '%.2f'|format(total_amount_raw|default(total)|float) }}</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Footer Section -->
        <div class="footer-section">
            <div class="footer-left">
                <div class="footer-block">
                    <div class="footer-title">Billing Information</div>
                    <div class="footer-content">
                        {% if billing_address %}
                        {{ billing_address }}<br>
                        {% else %}
                        {{ buyer_name|default(customer_name)|default('Billing address will be here') }}<br>
                        {{ buyer_address|default(customer_address)|default('Billing address will be here') }}<br>
                        {{ buyer_city|default(customer_city)|default('Billing address will be here') }}
                        {% endif %}
                    </div>
                </div>
                <div class="footer-block">
                    <div class="footer-title">Shipping Method</div>
                    <div class="footer-content">{{ shipping_method|default('FLAT RATE SHIPPING') }}</div>
                </div>
            </div>
            <div class="footer-right">
                <div class="footer-block">
                    <div class="footer-title">Shipping Information</div>
                    <div class="footer-content">
                        {% if shipping_address %}
                        {{ shipping_address }}<br>
                        {% else %}
                        {{ shipping_name|default('Shipping address will be here') }}<br>
                        {{ shipping_street|default('Shipping address will be here') }}<br>
                        {{ shipping_city|default('Shipping address will be here') }}
                        {% endif %}
                    </div>
                </div>
                <div class="footer-block">
                    <div class="footer-title">Payment Method</div>
                    <div class="footer-content">{{ payment_method|default('PayPal') }}</div>
                </div>
            </div>
        </div>
        {% endif %}

        {% if _total_pages|default(1) > 1 %}
        <div class="page-number">Page {{ _current_page|default(_page_number)|default(1) }} of {{ _total_pages|default(1) }}</div>
        {% endif %}
    </div>
</body>
</html>

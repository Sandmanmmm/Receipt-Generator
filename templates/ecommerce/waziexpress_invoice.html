<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WaziExpress Invoice</title>
    <link rel="stylesheet" href="../css/waziexpress_invoice.css">
</head>
<body>
    <div class="invoice-page">
        {% if _is_first_page|default(true) %}
        <!-- Header Section -->
        <table class="header-table">
            <tr>
                <td class="logo-cell">
                    {% if supplier_logo %}
                    <img src="{{ supplier_logo }}" alt="WaziExpress" class="company-logo" />
                    {% else %}
                    <div class="logo-placeholder">
                        <span class="logo-text">WaziExpressÂ®</span>
                    </div>
                    {% endif %}
                </td>
                <td class="company-info-cell" colspan="2">
                    <div class="company-name">{{ company_name|default('Waliwaba (China) Co., Ltd') }}</div>
                    <div class="company-address-line">{{ company_address|default('969 West Wen Yi Road') }}</div>
                    <div class="company-address-line">{{ company_city|default('Yu Hang District, Hangzhou 311121, China') }}</div>
                    <div class="company-reg">Reg. number: {{ company_reg|default('330100500024149') }}</div>
                </td>
            </tr>
        </table>

        <!-- Invoice Title Bar -->
        <div class="invoice-title-section">
            <div class="invoice-title-left">
                <div class="invoice-title">INVOICE</div>
                <div class="invoice-meta">
                    <div class="meta-item">No {{ invoice_number|default('937982796180055') }}</div>
                    <div class="meta-item">Date: {{ invoice_date|default('2018-08-09') }}</div>
                </div>
            </div>
            <div class="invoice-barcode">
                {% if barcode_base64 %}
                <img src="data:image/png;base64,{{ barcode_base64 }}" alt="Barcode" style="height: 60px; width: auto;">
                {% else %}
                <div class="barcode-placeholder">
                    <div class="barcode-lines">
                        <div class="barcode-line"></div>
                        <div class="barcode-line"></div>
                        <div class="barcode-line"></div>
                        <div class="barcode-line"></div>
                        <div class="barcode-line"></div>
                    </div>
                    <div class="barcode-number">{{ invoice_number|default('937982796180055') }}</div>
                </div>
                {% endif %}
            </div>
            <div class="invoice-buyer-info">
                <div class="buyer-details">
                    <div class="buyer-line"><strong>Company name:</strong> {{ buyer_company|default('MY COMPANY NAME') }}</div>
                    <div class="buyer-line"><strong>Address:</strong> {{ buyer_address|default('MY ADDRESS') }}</div>
                    <div class="buyer-line">{{ buyer_city|default('MY CITY, STATE & ZIP') }}</div>
                    <div class="buyer-line"><strong>Reg. number:</strong> {{ buyer_reg|default('MY REGISTRATION NUMBER') }}</div>
                    <div class="buyer-line"><strong>VAT number:</strong> {{ buyer_vat|default('MY VAT NUMBER') }}</div>
                </div>
            </div>
        </div>

        <!-- Store Info Bar -->
        <div class="store-info-bar">
            <div class="store-label">Store:</div>
            <div class="store-name">{{ store_name|default('HIPERDEAL Store') }}</div>
        </div>

        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-number">Product Details</th>
                    <th class="col-price">Price Per Unit</th>
                    <th class="col-qty">Quantity</th>
                    <th class="col-total">Order Total</th>
                </tr>
            </thead>
            <tbody>
        {% else %}
        <!-- Continuation Header -->
        <div class="continuation-header">
            <div class="cont-invoice-number">Invoice #{{ invoice_number }} (Page {{ _page_number }} of {{ _total_pages }})</div>
        </div>

        <table class="items-table continuation-table">
            <thead>
                <tr>
                    <th class="col-number">Product Details</th>
                    <th class="col-price">Price Per Unit</th>
                    <th class="col-qty">Quantity</th>
                    <th class="col-total">Order Total</th>
                </tr>
            </thead>
            <tbody>
        {% endif %}
                
                <!-- Line Items -->
                {% for item in items %}
                <tr class="item-row">
                    <td class="item-details">
                        {% if item.image %}
                        <img src="{{ item.image }}" alt="{{ item.name|default(item.description) }}" class="item-image" />
                        {% endif %}
                        <div class="item-text">
                            <div class="item-name">{{ item.name|default(item.description)|default('Product') }}</div>
                            {% if item.color or item.size %}
                            <div class="item-attributes">
                                Color: {{ item.color|default('Black') }}{% if item.size %} {{ item.size }}{% endif %}
                            </div>
                            {% endif %}
                            {% if item.variant %}
                            <div class="item-variant">{{ item.variant }}</div>
                            {% endif %}
                        </div>
                    </td>
                    <td class="item-price">
                        {% if item.unit_price is defined and item.unit_price is not none %}
                            {% if item.unit_price is string %}
                                {% if not item.unit_price.startswith('$') %}$ {% endif %}{{ item.unit_price }}
                            {% else %}
                                $ {{ "%.2f"|format(item.unit_price|to_float) }}
                            {% endif %}
                        {% elif item.rate is defined and item.rate is not none %}
                            {% if item.rate is string %}
                                {% if not item.rate.startswith('$') %}$ {% endif %}{{ item.rate }}
                            {% else %}
                                $ {{ "%.2f"|format(item.rate) }}
                            {% endif %}
                        {% else %}
                            $ 0.00
                        {% endif %}
                    </td>
                    <td class="item-qty">{{ item.quantity|default(1) }} piece</td>
                    <td class="item-total">
                        {% if item.total is defined and item.total is not none %}
                            {% if item.total is string %}
                                {% if not item.total.startswith('$') %}$ {% endif %}{{ item.total }}
                            {% else %}
                                $ {{ "%.2f"|format(item.total|to_float) }}
                            {% endif %}
                        {% elif item.amount is defined and item.amount is not none %}
                            {% if item.amount is string %}
                                {% if not item.amount.startswith('$') %}$ {% endif %}{{ item.amount }}
                            {% else %}
                                $ {{ "%.2f"|format(item.amount|to_float) }}
                            {% endif %}
                        {% else %}
                            $ 0.00
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if _is_last_page|default(true) %}
        <!-- Total Amount Section -->
        <div class="total-section">
            <div class="total-header">Total Amount</div>
            <table class="totals-breakdown-table">
                <tr>
                    <td class="breakdown-label">Price</td>
                    <td class="breakdown-label">Shipping Cost</td>
                    <td class="breakdown-label">Adjust Price</td>
                    <td class="breakdown-label">Discount</td>
                    <td class="breakdown-label-right">Total Amount</td>
                </tr>
                <tr>
                    <td class="breakdown-value">{{ subtotal|default('$ 0.00') }}</td>
                    <td class="breakdown-value">{{ shipping_cost|default('$ 0.00') }}</td>
                    <td class="breakdown-value">{{ adjust_price|default('') }}</td>
                    <td class="breakdown-value">{{ discount|default('$ 0.00') }}</td>
                    <td class="breakdown-value-right">{{ total_amount|default('$ 0.00') }}</td>
                </tr>
            </table>
        </div>

        <!-- Payment Received Section -->
        <div class="payment-section">
            <div class="payment-header">Payment Received:</div>
            <table class="payment-table">
                <tr>
                    <td class="payment-label">Total</td>
                    <td class="payment-label">Received</td>
                    <td class="payment-label">Payment Method</td>
                    <td class="payment-label-right">Date Received</td>
                </tr>
                <tr>
                    <td class="payment-value">{{ total_amount|default('$ 0.00') }}</td>
                    <td class="payment-value">{{ payment_received|default(total_amount)|default('$ 0.00') }}</td>
                    <td class="payment-value">{{ payment_method|default('Credit Card') }}</td>
                    <td class="payment-value-right">{{ payment_date|default('2018-08-09 05:13') }}</td>
                </tr>
            </table>
        </div>

        <!-- Additional Information Section -->
        <div class="additional-info-section">
            <div class="info-header">Additional information:</div>
            <div class="vat-info">
                <div class="vat-label">VAT Information</div>
                <div class="vat-text">{{ vat_info|default('20% VAT included in price') }}</div>
            </div>
        </div>

        <!-- Shipping Section -->
        <div class="shipping-section">
            <div class="shipping-header">Shipping:</div>
            <div class="shipping-address">
                <div class="shipping-label">Ship to address</div>
                <div class="shipping-text">{{ shipping_address|default("Your customer's shipping address will be here") }}</div>
            </div>
        </div>

        <!-- Logistics Information Section -->
        <div class="logistics-section">
            <div class="logistics-header">Logistics Information:</div>
            <table class="logistics-table">
                <thead>
                    <tr>
                        <th class="logistics-col-company">International Shipping Company</th>
                        <th class="logistics-col-tracking">Tracking Number</th>
                        <th class="logistics-col-remarks">Remarks</th>
                        <th class="logistics-col-details">Details</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="logistics-value">{{ shipping_company|default('China Post Ordinary Small Packet Plus') }}</td>
                        <td class="logistics-value">{{ tracking_number|default('UNI10293022CN') }}</td>
                        <td class="logistics-value">{{ shipping_remarks|default('') }}</td>
                        <td class="logistics-details">
                            {% if tracking_details %}
                            {{ tracking_details }}
                            {% else %}
                            <div class="tracking-event">2018.08.11 03:27 (GMT+7): Shipment accepted by airline</div>
                            <div class="tracking-event">2018.08.11 03:15 (GMT+7): Shipment left country of origin warehouse</div>
                            <div class="tracking-event">2018.08.11 03:15 (GMT+7): Shipment at country of origin warehouse</div>
                            {% endif %}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Seller Sign -->
        <div class="seller-sign-section">
            <div class="seller-sign-label">Seller sign:</div>
            <div class="seller-sign-name">{{ seller_sign|default('Ruutanfs Six') }}</div>
        </div>
        {% else %}
        <!-- Continuation Footer -->
        <div class="continuation-footer">
            <div class="cont-footer-text">Continued on next page...</div>
            <div class="cont-footer-page">Page {{ _page_number }} of {{ _total_pages }}</div>
        </div>
        {% endif %}
    </div>
</body>
</html>

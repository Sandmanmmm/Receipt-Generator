<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ supplier_name|default('Global Export Corp') }} - Export Invoice</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            font-size: 10px;
            line-height: 1.4;
            color: #2d2d2d;
            background: #fff;
        }
        
        .invoice-page {
            width: 816px;
            min-height: 1056px;
            padding: 30px 40px;
            background: #fff;
            position: relative;
        }
        
        /* Navy Blue Header Strip */
        .header-strip {
            background: #1e3a5f;
            height: 8px;
            margin: -30px -40px 20px -40px;
            width: calc(100% + 80px);
        }
        
        /* Main Header */
        .main-header {
            display: table;
            width: 100%;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #1e3a5f;
        }
        
        .header-left {
            display: table-cell;
            width: 55%;
            vertical-align: top;
        }
        
        .header-right {
            display: table-cell;
            width: 45%;
            vertical-align: top;
            text-align: right;
        }
        
        .company-name {
            font-size: 26px;
            font-weight: 700;
            color: #1e3a5f;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .company-tagline {
            font-size: 11px;
            color: #d4a537;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 8px;
        }
        
        .company-details {
            font-size: 9px;
            color: #555;
            line-height: 1.5;
        }
        
        .invoice-box {
            background: #1e3a5f;
            color: #fff;
            padding: 15px 20px;
            text-align: center;
            display: inline-block;
        }
        
        .invoice-title {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .invoice-number {
            font-size: 14px;
            margin-top: 5px;
            color: #d4a537;
            font-weight: 600;
        }
        
        /* Party Information */
        .parties-section {
            display: table;
            width: 100%;
            margin-bottom: 15px;
        }
        
        .party-box {
            display: table-cell;
            width: 48%;
            padding: 15px;
            vertical-align: top;
            background: #f8f9fa;
            border-left: 4px solid #1e3a5f;
        }
        
        .party-box.right {
            border-left: 4px solid #d4a537;
        }
        
        .party-spacer {
            display: table-cell;
            width: 4%;
        }
        
        .party-title {
            font-size: 9px;
            font-weight: 700;
            color: #1e3a5f;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
        }
        
        .party-name {
            font-size: 12px;
            font-weight: 700;
            color: #2d2d2d;
            margin-bottom: 5px;
        }
        
        .party-detail {
            font-size: 9px;
            color: #555;
            margin-bottom: 2px;
        }
        
        /* Invoice Details Grid */
        .details-grid {
            display: table;
            width: 100%;
            margin-bottom: 15px;
            border: 1px solid #ddd;
        }
        
        .details-row {
            display: table-row;
        }
        
        .detail-cell {
            display: table-cell;
            padding: 8px 12px;
            border-right: 1px solid #ddd;
            border-bottom: 1px solid #ddd;
            font-size: 9px;
            vertical-align: top;
        }
        
        .detail-cell:last-child {
            border-right: none;
        }
        
        .details-row:last-child .detail-cell {
            border-bottom: none;
        }
        
        .detail-label {
            color: #1e3a5f;
            font-weight: 700;
            font-size: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: block;
            margin-bottom: 3px;
        }
        
        .detail-value {
            font-weight: 600;
            color: #2d2d2d;
        }
        
        /* Items Table */
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            table-layout: fixed;
        }
        
        .items-table thead {
            background: #1e3a5f;
        }
        
        .items-table th {
            color: #fff;
            font-size: 8px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 10px 6px;
            text-align: left;
            border: none;
        }
        
        .items-table th.center { text-align: center; }
        .items-table th.right { text-align: right; }
        
        .items-table td {
            padding: 10px 6px;
            border-bottom: 1px solid #e5e5e5;
            font-size: 9px;
            vertical-align: top;
            word-wrap: break-word;
        }
        
        .items-table tbody tr:nth-child(even) {
            background: #fafbfc;
        }
        
        .col-no { width: 5%; text-align: center; }
        .col-sku { width: 12%; }
        .col-desc { width: 28%; }
        .col-origin { width: 8%; text-align: center; }
        .col-qty { width: 8%; text-align: center; }
        .col-unit { width: 10%; text-align: right; }
        .col-disc { width: 8%; text-align: center; }
        .col-tax { width: 8%; text-align: center; }
        .col-total { width: 13%; text-align: right; font-weight: 700; }
        
        .item-name {
            font-weight: 600;
            color: #2d2d2d;
        }
        
        .item-variant {
            font-size: 8px;
            color: #777;
            margin-top: 2px;
        }
        
        .item-hs {
            font-size: 7px;
            color: #999;
            font-family: 'Consolas', monospace;
        }
        
        /* Summary Section */
        .summary-section {
            display: table;
            width: 100%;
            margin-bottom: 20px;
        }
        
        .summary-left {
            display: table-cell;
            width: 55%;
            vertical-align: top;
            padding-right: 20px;
        }
        
        .summary-right {
            display: table-cell;
            width: 45%;
            vertical-align: top;
        }
        
        /* Shipping Info Box */
        .shipping-box {
            border: 1px solid #ddd;
            padding: 12px;
            background: #fafbfc;
        }
        
        .shipping-title {
            font-size: 9px;
            font-weight: 700;
            color: #1e3a5f;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
        }
        
        .shipping-row {
            display: table;
            width: 100%;
            margin-bottom: 4px;
        }
        
        .shipping-label {
            display: table-cell;
            width: 45%;
            font-size: 8px;
            color: #777;
        }
        
        .shipping-value {
            display: table-cell;
            width: 55%;
            font-size: 9px;
            font-weight: 500;
            color: #2d2d2d;
        }
        
        /* Totals Table */
        .totals-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        
        .totals-table td {
            padding: 8px 12px;
            font-size: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .totals-table td:first-child {
            text-align: left;
            color: #555;
            width: 60%;
        }
        
        .totals-table td:last-child {
            text-align: right;
            font-weight: 600;
            width: 40%;
        }
        
        .totals-table tr.total-row {
            background: #1e3a5f;
        }
        
        .totals-table tr.total-row td {
            color: #fff;
            font-size: 12px;
            font-weight: 700;
            padding: 12px;
            border-bottom: none;
        }
        
        .totals-table tr.total-row td:last-child {
            color: #d4a537;
        }
        
        /* Amount in Words */
        .amount-words {
            background: linear-gradient(90deg, #1e3a5f 0%, #2a4a73 100%);
            color: #fff;
            padding: 12px 15px;
            margin-bottom: 20px;
        }
        
        .amount-words-label {
            font-size: 8px;
            color: #d4a537;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        
        .amount-words-text {
            font-size: 11px;
            font-weight: 600;
            margin-top: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Bank & Terms Section */
        .bottom-section {
            display: table;
            width: 100%;
            margin-bottom: 25px;
        }
        
        .bank-box {
            display: table-cell;
            width: 48%;
            vertical-align: top;
            border: 1px solid #ddd;
            padding: 12px;
        }
        
        .terms-box {
            display: table-cell;
            width: 48%;
            vertical-align: top;
            border: 1px solid #ddd;
            padding: 12px;
            border-left: none;
        }
        
        .section-title {
            font-size: 9px;
            font-weight: 700;
            color: #1e3a5f;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 2px solid #d4a537;
        }
        
        .bank-row {
            margin-bottom: 4px;
        }
        
        .bank-label {
            font-size: 8px;
            color: #777;
            display: inline-block;
            width: 80px;
        }
        
        .bank-value {
            font-size: 9px;
            font-weight: 500;
            color: #2d2d2d;
        }
        
        .terms-text {
            font-size: 8px;
            color: #555;
            line-height: 1.5;
            margin-bottom: 8px;
        }
        
        /* Signature Section */
        .signature-section {
            display: table;
            width: 100%;
            margin-top: 30px;
        }
        
        .sig-box {
            display: table-cell;
            width: 30%;
            vertical-align: bottom;
            text-align: center;
            padding: 0 10px;
        }
        
        .sig-box.stamp-area {
            width: 40%;
        }
        
        .sig-line {
            border-bottom: 1px solid #2d2d2d;
            height: 50px;
            margin-bottom: 5px;
        }
        
        .sig-label {
            font-size: 8px;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Export Stamp - Circular Official Seal Design */
        .export-stamp {
            width: 120px;
            height: 120px;
            position: relative;
            display: inline-block;
            transform: rotate(-8deg);
            margin: 5px auto;
        }
        
        .stamp-outer-ring {
            width: 120px;
            height: 120px;
            border: 4px solid #1e3a5f;
            border-radius: 50%;
            position: absolute;
            top: 0;
            left: 0;
            box-sizing: border-box;
        }
        
        .stamp-middle-ring {
            width: 104px;
            height: 104px;
            border: 2px solid #1e3a5f;
            border-radius: 50%;
            position: absolute;
            top: 8px;
            left: 8px;
            box-sizing: border-box;
        }
        
        .stamp-inner-ring {
            width: 70px;
            height: 70px;
            border: 2px dashed #1e3a5f;
            border-radius: 50%;
            position: absolute;
            top: 25px;
            left: 25px;
            box-sizing: border-box;
        }
        
        .stamp-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 58px;
            z-index: 10;
        }
        
        .stamp-icon {
            font-size: 20px;
            color: #1e3a5f;
            margin-bottom: 2px;
        }
        
        .stamp-text-main {
            font-size: 8px;
            font-weight: 800;
            color: #1e3a5f;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1.2;
        }
        
        .stamp-text-sub {
            font-size: 6px;
            color: #1e3a5f;
            font-weight: 600;
            margin-top: 2px;
        }
        
        .stamp-company-top {
            position: absolute;
            top: 15px;
            left: 0;
            width: 120px;
            text-align: center;
            font-size: 6px;
            font-weight: 700;
            color: #1e3a5f;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stamp-location-bottom {
            position: absolute;
            bottom: 15px;
            left: 0;
            width: 120px;
            text-align: center;
            font-size: 5px;
            font-weight: 600;
            color: #1e3a5f;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .stamp-star-left {
            position: absolute;
            top: 50%;
            left: 12px;
            transform: translateY(-50%);
            font-size: 8px;
            color: #1e3a5f;
        }
        
        .stamp-star-right {
            position: absolute;
            top: 50%;
            right: 12px;
            transform: translateY(-50%);
            font-size: 8px;
            color: #1e3a5f;
        }
        
        /* Footer */
        .footer {
            position: absolute;
            bottom: 25px;
            left: 40px;
            right: 40px;
            border-top: 2px solid #1e3a5f;
            padding-top: 10px;
            display: table;
            width: calc(100% - 80px);
        }
        
        .footer-left {
            display: table-cell;
            width: 60%;
            font-size: 8px;
            color: #777;
        }
        
        .footer-center {
            display: table-cell;
            width: 20%;
            text-align: center;
        }
        
        .footer-right {
            display: table-cell;
            width: 20%;
            text-align: right;
        }
        
        .footer-website {
            font-size: 9px;
            color: #1e3a5f;
            font-weight: 600;
        }
        
        /* Gold accent badge */
        .quality-badge {
            display: inline-block;
            background: #d4a537;
            color: #fff;
            font-size: 7px;
            font-weight: 700;
            padding: 3px 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Page Number */
        .page-number {
            text-align: center;
            font-size: 8px;
            color: #999;
            margin-top: 15px;
        }
        
        /* Continuation Header */
        .continuation-header {
            background: #1e3a5f;
            color: #fff;
            padding: 12px 20px;
            margin: -30px -40px 15px -40px;
            width: calc(100% + 80px);
            display: table;
        }
        
        .cont-left {
            display: table-cell;
            width: 60%;
            font-size: 14px;
            font-weight: 700;
        }
        
        .cont-right {
            display: table-cell;
            width: 40%;
            text-align: right;
            font-size: 10px;
            color: #d4a537;
        }
        
        /* Watermark */
        .watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-25deg);
            font-size: 70px;
            color: rgba(30, 58, 95, 0.03);
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 15px;
            white-space: nowrap;
            pointer-events: none;
            z-index: 0;
        }
    </style>
</head>
<body>
    <div class="invoice-page">
        <!-- Watermark -->
        <div class="watermark">{{ watermark_text|default('EXPORT') }}</div>
        
        {% if _is_first_page|default(true) %}
        <!-- Header Strip -->
        <div class="header-strip"></div>
        
        <!-- Main Header -->
        <div class="main-header">
            <div class="header-left">
                <div class="company-name">{{ supplier_name|default('GLOBAL EXPORT CORP') }}</div>
                <div class="company-tagline">{{ company_tagline|default('International Trade Solutions') }}</div>
                <div class="company-details">
                    {{ store_address|default('500 Commerce Tower, Business Bay') }}<br>
                    {{ store_city|default('Dubai') }}, {{ store_country|default('United Arab Emirates') }} {{ store_postal|default('') }}<br>
                    Tel: {{ store_phone|default('+971 4 555 1234') }} | Fax: {{ store_fax|default('+971 4 555 1235') }}<br>
                    Email: {{ store_email|default('export@globalcorp.ae') }}
                </div>
            </div>
            <div class="header-right">
                <div class="invoice-box">
                    <div class="invoice-title">Export Invoice</div>
                    <div class="invoice-number">{{ invoice_number|default(po_number)|default(order_number)|default('EXP-2024-00001') }}</div>
                </div>
                <div style="margin-top: 10px;">
                    <span class="quality-badge">{{ certification_badge|default('ISO 9001:2015') }}</span>
                </div>
            </div>
        </div>
        
        <!-- Parties Section -->
        <div class="parties-section">
            <div class="party-box">
                <div class="party-title">Exporter / Seller</div>
                <div class="party-name">{{ exporter_name|default(supplier_name)|default('Global Export Corp') }}</div>
                <div class="party-detail">{{ exporter_address|default(store_address)|default('500 Commerce Tower, Business Bay') }}</div>
                <div class="party-detail">{{ exporter_city|default(store_city)|default('Dubai') }}, {{ exporter_country|default(store_country)|default('UAE') }}</div>
                <div class="party-detail">Tax ID: {{ exporter_tax_id|default('TRN-100234567890003') }}</div>
            </div>
            <div class="party-spacer"></div>
            <div class="party-box right">
                <div class="party-title">Importer / Buyer</div>
                <div class="party-name">{{ buyer_company|default(buyer_name)|default('International Imports Ltd') }}</div>
                <div class="party-detail">{{ buyer_address|default('1000 Trade Center Drive') }}</div>
                <div class="party-detail">{{ buyer_city|default('New York') }}, {{ buyer_state|default('NY') }} {{ buyer_postal|default('10001') }}</div>
                <div class="party-detail">{{ buyer_country|default('United States') }}</div>
                {% if buyer_tax_id %}
                <div class="party-detail">Tax ID: {{ buyer_tax_id }}</div>
                {% endif %}
            </div>
        </div>
        
        <!-- Invoice Details Grid -->
        <div class="details-grid">
            <div class="details-row">
                <div class="detail-cell" style="width: 16%;">
                    <span class="detail-label">Invoice Date</span>
                    <span class="detail-value">{{ invoice_date|default(po_date)|default(order_date)|default('Dec 08, 2024') }}</span>
                </div>
                <div class="detail-cell" style="width: 16%;">
                    <span class="detail-label">Due Date</span>
                    <span class="detail-value">{{ due_date|default('Jan 07, 2025') }}</span>
                </div>
                <div class="detail-cell" style="width: 17%;">
                    <span class="detail-label">Payment Terms</span>
                    <span class="detail-value">{{ payment_terms|default('Net 30') }}</span>
                </div>
                <div class="detail-cell" style="width: 17%;">
                    <span class="detail-label">Currency</span>
                    <span class="detail-value">{{ currency_code|default('USD') }}</span>
                </div>
                <div class="detail-cell" style="width: 17%;">
                    <span class="detail-label">Incoterms</span>
                    <span class="detail-value">{{ incoterms|default('CIF New York') }}</span>
                </div>
                <div class="detail-cell" style="width: 17%;">
                    <span class="detail-label">Origin</span>
                    <span class="detail-value">{{ origin_country|default('UAE/China') }}</span>
                </div>
            </div>
        </div>
        {% else %}
        <!-- Continuation Header -->
        <div class="continuation-header">
            <div class="cont-left">{{ supplier_name|default('GLOBAL EXPORT CORP') }}</div>
            <div class="cont-right">Invoice {{ invoice_number|default(po_number)|default(order_number) }} — Page {{ _current_page|default(_page_number)|default(1) }}/{{ _total_pages|default(1) }}</div>
        </div>
        {% endif %}
        
        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-no">#</th>
                    <th class="col-sku">SKU / HS Code</th>
                    <th class="col-desc">Description</th>
                    <th class="col-origin center">Origin</th>
                    <th class="col-qty center">Qty</th>
                    <th class="col-unit right">Unit Price</th>
                    <th class="col-disc center">Disc %</th>
                    <th class="col-tax center">Tax %</th>
                    <th class="col-total right">Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for item in line_items|default(items)|default([]) %}
                {% set item_price = item.unit_price|default(item.unit_cost)|default(item.rate)|default(item.price)|default(0) %}
                {% set price_val = item_price|string|replace('$','')|replace('€','')|replace('£','')|replace('¥','')|replace('₹','')|replace('RM','')|replace(',','')|float %}
                {% set item_qty = item.quantity_ordered|default(item.quantity)|default(1)|int %}
                {% set item_total_val = item.line_total|default(item.total)|default(item.amount)|default(price_val * item_qty) %}
                {% set total_val = item_total_val|string|replace('$','')|replace('€','')|replace('£','')|replace('¥','')|replace('₹','')|replace('RM','')|replace(',','')|float %}
                <tr>
                    <td class="col-no">{{ loop.index }}</td>
                    <td class="col-sku">
                        <div>{{ item.supplier_sku|default(item.sku)|default(item.mpn)|default('-') }}</div>
                        <div class="item-hs">{{ item.hs_code|default('8471.30.00') }}</div>
                    </td>
                    <td class="col-desc">
                        <div class="item-name">{{ item.product_name|default(item.description)|default(item.name)|default('Product') }}</div>
                        {% if item.brand or item.color or item.size %}
                        <div class="item-variant">
                            {% if item.brand %}{{ item.brand }}{% endif %}
                            {% if item.color %} • {{ item.color }}{% endif %}
                            {% if item.size %} • {{ item.size }}{% endif %}
                        </div>
                        {% endif %}
                    </td>
                    <td class="col-origin">{{ item.origin_country|default(item.country_of_origin)|default('CN') }}</td>
                    <td class="col-qty">{{ item_qty }}</td>
                    <td class="col-unit">{{ currency_symbol|default('$') }}{{ '%.2f'|format(price_val) }}</td>
                    <td class="col-disc">{{ item.discount_percent|default('0') }}%</td>
                    <td class="col-tax">{{ ((item.tax_rate|default(tax_rate)|default(0))|float * (100 if (item.tax_rate|default(tax_rate)|default(0))|float < 1 else 1))|int }}%</td>
                    <td class="col-total">{{ currency_symbol|default('$') }}{{ '%.2f'|format(total_val) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        {% if _is_last_page|default(true) %}
        <!-- Summary Section -->
        <div class="summary-section">
            <div class="summary-left">
                <!-- Shipping Info -->
                <div class="shipping-box">
                    <div class="shipping-title">Shipping & Logistics</div>
                    <div class="shipping-row">
                        <div class="shipping-label">Port of Loading:</div>
                        <div class="shipping-value">{{ port_of_loading|default('Jebel Ali, Dubai') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">Port of Discharge:</div>
                        <div class="shipping-value">{{ port_of_discharge|default('Port of New York') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">Shipping Method:</div>
                        <div class="shipping-value">{{ shipping_method|default('Sea Freight - FCL 40ft') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">Vessel / Flight:</div>
                        <div class="shipping-value">{{ vessel_name|default('MSC Gülsün') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">ETD / ETA:</div>
                        <div class="shipping-value">{{ etd|default('Dec 15') }} / {{ eta|default('Jan 10') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">Total Packages:</div>
                        <div class="shipping-value">{{ total_packages|default('24 Pallets (480 Cartons)') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">Gross Weight:</div>
                        <div class="shipping-value">{{ gross_weight|default('5,200 KG') }}</div>
                    </div>
                    <div class="shipping-row">
                        <div class="shipping-label">Volume:</div>
                        <div class="shipping-value">{{ volume|default('28 CBM') }}</div>
                    </div>
                </div>
            </div>
            <div class="summary-right">
                <!-- Totals -->
                <table class="totals-table">
                    <tr>
                        <td>Subtotal:</td>
                        <td>{{ currency_symbol|default('$') }}{{ '%.2f'|format(subtotal|default(subtotal_raw)|default(0)|float) }}</td>
                    </tr>
                    {% if (discount_raw|default(0)|float) > 0 %}
                    <tr>
                        <td>Trade Discount:</td>
                        <td>-{{ currency_symbol|default('$') }}{{ '%.2f'|format(discount_raw|float) }}</td>
                    </tr>
                    {% endif %}
                    {% if (shipping_cost|default(freight_cost)|default(0)|float) > 0 %}
                    <tr>
                        <td>Freight & Insurance:</td>
                        <td>{{ currency_symbol|default('$') }}{{ '%.2f'|format(shipping_cost|default(freight_cost)|float) }}</td>
                    </tr>
                    {% endif %}
                    {% if (tax_amount|default(tax_amount_raw)|default(0)|float) > 0 %}
                    <tr>
                        <td>VAT / Duties:</td>
                        <td>{{ currency_symbol|default('$') }}{{ '%.2f'|format(tax_amount|default(tax_amount_raw)|float) }}</td>
                    </tr>
                    {% endif %}
                    <tr class="total-row">
                        <td>Total {{ currency_code|default('USD') }}:</td>
                        <td>{{ currency_symbol|default('$') }}{{ '%.2f'|format(total_amount|default(total)|default(grand_total)|default(0)|float) }}</td>
                    </tr>
                </table>
            </div>
        </div>
        
        <!-- Amount in Words -->
        <div class="amount-words">
            <div class="amount-words-label">Total Amount in Words ({{ currency_code|default('USD') }})</div>
            <div class="amount-words-text">{{ amount_in_words|default('TWELVE THOUSAND FIVE HUNDRED DOLLARS AND ZERO CENTS ONLY') }}</div>
        </div>
        
        <!-- Bank & Terms -->
        <div class="bottom-section">
            <div class="bank-box">
                <div class="section-title">Wire Transfer Details</div>
                <div class="bank-row">
                    <span class="bank-label">Bank Name:</span>
                    <span class="bank-value">{{ bank_name|default('Emirates NBD') }}</span>
                </div>
                <div class="bank-row">
                    <span class="bank-label">Account:</span>
                    <span class="bank-value">{{ bank_account_name|default(supplier_name)|default('Global Export Corp LLC') }}</span>
                </div>
                <div class="bank-row">
                    <span class="bank-label">Account No:</span>
                    <span class="bank-value">{{ bank_account_number|default('1015-123456-001') }}</span>
                </div>
                <div class="bank-row">
                    <span class="bank-label">IBAN:</span>
                    <span class="bank-value">{{ iban|default('AE070331234567890123456') }}</span>
                </div>
                <div class="bank-row">
                    <span class="bank-label">SWIFT:</span>
                    <span class="bank-value">{{ swift_code|default('EABORAEA') }}</span>
                </div>
            </div>
            <div class="terms-box">
                <div class="section-title">Terms & Conditions</div>
                <div class="terms-text">
                    {{ terms_text|default('1. Payment due within the terms specified above.') }}<br>
                    {{ terms_text_2|default('2. Late payments subject to 1.5% monthly interest.') }}<br>
                    {{ terms_text_3|default('3. Goods remain property of seller until fully paid.') }}<br>
                    {{ terms_text_4|default('4. Claims must be made within 7 days of receipt.') }}<br>
                    {{ terms_text_5|default('5. Subject to jurisdiction of Dubai Courts, UAE.') }}
                </div>
            </div>
        </div>
        
        <!-- Signature Section with Hexagon Stamp -->
        <div class="signature-section">
            <div class="sig-box">
                <div class="sig-line"></div>
                <div class="sig-label">Prepared By</div>
            </div>
            <div class="sig-box stamp-area">
                <!-- Export Stamp - Circular Official Seal -->
                <div class="export-stamp">
                    <div class="stamp-outer-ring"></div>
                    <div class="stamp-middle-ring"></div>
                    <div class="stamp-inner-ring"></div>
                    <div class="stamp-company-top">{{ stamp_company|default(supplier_name)|default('GLOBAL EXPORT CORP') }}</div>
                    <div class="stamp-star-left">★</div>
                    <div class="stamp-content">
                        <div class="stamp-icon">✓</div>
                        <div class="stamp-text-main">VERIFIED</div>
                        <div class="stamp-text-sub">{{ stamp_date|default('DEC 2024') }}</div>
                    </div>
                    <div class="stamp-star-right">★</div>
                    <div class="stamp-location-bottom">{{ stamp_location|default(store_city)|default('DUBAI') }} • {{ store_country|default('UAE') }}</div>
                </div>
            </div>
            <div class="sig-box">
                <div class="sig-line"></div>
                <div class="sig-label">Authorized Signature</div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <div class="footer-left">
                This is a computer-generated export invoice. For inquiries: {{ store_email|default('export@globalcorp.ae') }}
            </div>
            <div class="footer-center">
                <span class="quality-badge">{{ footer_badge|default('VERIFIED EXPORTER') }}</span>
            </div>
            <div class="footer-right">
                <div class="footer-website">{{ store_website|default('www.globalexportcorp.ae') }}</div>
            </div>
        </div>
        {% else %}
        <!-- Continuation Footer -->
        <div style="text-align: center; margin-top: 25px; font-size: 9px; color: #777;">
            Continued on next page...
        </div>
        {% endif %}
        
        {% if _total_pages|default(1) > 1 %}
        <div class="page-number">Page {{ _current_page|default(_page_number)|default(1) }} of {{ _total_pages|default(1) }}</div>
        {% endif %}
    </div>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electric Bill</title>
    <link rel="stylesheet" href="../css/utility_bill.css">
</head>
<body>
    <div class="utility-bill electric-bill">
        <!-- Header -->
        <div class="bill-header">
            <div class="provider-info">
                <h1 class="provider-name">{{ supplier_name }}</h1>
                <p class="provider-tagline">Electric Power Services</p>
                <p class="provider-contact">{{ supplier_phone }} | {{ supplier_email }}</p>
            </div>
            <div class="bill-meta">
                <h2 class="bill-type">ELECTRIC BILL</h2>
                <p><strong>Account Number:</strong> <span class="account-number">{{ account_number }}</span></p>
                <p><strong>Bill Date:</strong> {{ invoice_date }}</p>
                <p><strong>Due Date:</strong> <span class="due-date">{{ due_date }}</span></p>
                <p><strong>Meter Number:</strong> <span class="meter-number">{{ meter_number }}</span></p>
            </div>
        </div>

        <!-- Account Summary -->
        <div class="account-summary">
            <div class="summary-item balance-item">
                <span class="summary-label">Previous Balance</span>
                <span class="summary-value">{{ previous_balance }}</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">Payments Received</span>
                <span class="summary-value payment-received">-{{ payment_received }}</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">Current Charges</span>
                <span class="summary-value">{{ current_charges }}</span>
            </div>
            <div class="summary-item total-item">
                <span class="summary-label">Total Amount Due</span>
                <span class="summary-value total-due">{{ amount_due }}</span>
            </div>
        </div>

        <!-- Customer Information -->
        <div class="customer-info-section">
            <h3>Service Address</h3>
            <div class="customer-details">
                <p class="customer-name">{{ buyer_name }}</p>
                <p class="service-address">{{ buyer_address }}</p>
                <p class="customer-contact">{{ buyer_phone }}</p>
            </div>
        </div>

        <!-- Billing Period & Usage -->
        <div class="usage-section">
            <div class="billing-period-box">
                <h3>Billing Period</h3>
                <p class="billing-period">{{ billing_period }}</p>
                <p class="service-days"><strong>Service Days:</strong> {{ service_days }}</p>
            </div>

            <div class="meter-readings">
                <h3>Meter Readings</h3>
                <table class="readings-table">
                    <thead>
                        <tr>
                            <th>Reading Type</th>
                            <th>Date</th>
                            <th>Reading</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="reading-type">Previous Reading</td>
                            <td class="reading-date">{{ previous_reading_date }}</td>
                            <td class="reading-value previous-reading">{{ previous_reading }}</td>
                        </tr>
                        <tr>
                            <td class="reading-type">Current Reading</td>
                            <td class="reading-date">{{ current_reading_date }}</td>
                            <td class="reading-value current-reading">{{ current_reading }}</td>
                        </tr>
                        <tr class="usage-row">
                            <td class="reading-type"><strong>Total Usage</strong></td>
                            <td></td>
                            <td class="reading-value usage-amount"><strong>{{ usage_amount }} kWh</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Usage Graph (Visual representation) -->
        <div class="usage-graph-section">
            <h3>Monthly Usage Comparison</h3>
            <div class="usage-bars">
                {% for month in usage_history %}
                <div class="usage-bar-container">
                    <div class="usage-bar" style="height: {{ month.percentage }}%;">
                        <span class="usage-value">{{ month.kwh }}</span>
                    </div>
                    <span class="month-label">{{ month.name }}</span>
                </div>
                {% endfor %}
            </div>
            <p class="usage-note">Your usage is <strong>{{ usage_comparison }}</strong> compared to last year.</p>
        </div>

        <!-- Charges Breakdown -->
        <div class="charges-section">
            <h3>Charges Breakdown</h3>
            <table class="charges-table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Rate</th>
                        <th>Usage/Quantity</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Energy Charges -->
                    <tr class="category-header">
                        <td colspan="4"><strong>Energy Charges</strong></td>
                    </tr>
                    {% for tier in energy_tiers %}
                    <tr>
                        <td class="charge-description">{{ tier.name }} ({{ tier.range }})</td>
                        <td class="rate">{{ tier.rate_per_unit }}</td>
                        <td class="quantity">{{ tier.kwh }} kWh</td>
                        <td class="amount">{{ tier.charge }}</td>
                    </tr>
                    {% endfor %}
                    
                    <!-- Distribution Charges -->
                    <tr class="category-header">
                        <td colspan="4"><strong>Distribution & Delivery</strong></td>
                    </tr>
                    <tr>
                        <td class="charge-description">Distribution Charge</td>
                        <td class="rate">{{ distribution_rate }}</td>
                        <td class="quantity">{{ usage_amount }} kWh</td>
                        <td class="amount">{{ distribution_charge }}</td>
                    </tr>
                    <tr>
                        <td class="charge-description">Transmission Charge</td>
                        <td class="rate">{{ transmission_rate }}</td>
                        <td class="quantity">{{ usage_amount }} kWh</td>
                        <td class="amount">{{ transmission_charge }}</td>
                    </tr>

                    <!-- Fixed Charges -->
                    <tr class="category-header">
                        <td colspan="4"><strong>Fixed Charges</strong></td>
                    </tr>
                    <tr>
                        <td class="charge-description">Customer Service Charge</td>
                        <td class="rate">Fixed</td>
                        <td class="quantity">-</td>
                        <td class="amount">{{ service_charge }}</td>
                    </tr>
                    {% if meter_charge > 0 %}
                    <tr>
                        <td class="charge-description">Meter Charge</td>
                        <td class="rate">Fixed</td>
                        <td class="quantity">-</td>
                        <td class="amount">{{ meter_charge }}</td>
                    </tr>
                    {% endif %}

                    <!-- Adjustments -->
                    {% if fuel_adjustment != 0 %}
                    <tr class="category-header">
                        <td colspan="4"><strong>Adjustments</strong></td>
                    </tr>
                    <tr>
                        <td class="charge-description">Fuel Cost Adjustment</td>
                        <td class="rate">{{ fuel_adjustment_rate }}</td>
                        <td class="quantity">{{ usage_amount }} kWh</td>
                        <td class="amount adjustment">{{ fuel_adjustment }}</td>
                    </tr>
                    {% endif %}

                    {% if late_payment_fee > 0 %}
                    <tr>
                        <td class="charge-description late-fee">Late Payment Fee</td>
                        <td class="rate">-</td>
                        <td class="quantity">-</td>
                        <td class="amount late-fee">{{ late_payment_fee }}</td>
                    </tr>
                    {% endif %}
                </tbody>
                <tfoot>
                    <tr class="subtotal-row">
                        <td colspan="3">Subtotal</td>
                        <td class="subtotal">{{ subtotal }}</td>
                    </tr>
                    <tr>
                        <td colspan="3">Sales Tax ({{ tax_rate }}%)</td>
                        <td class="tax">{{ tax_amount }}</td>
                    </tr>
                    {% if regulatory_charges > 0 %}
                    <tr>
                        <td colspan="3">Regulatory Charges & Fees</td>
                        <td class="tax">{{ regulatory_charges }}</td>
                    </tr>
                    {% endif %}
                    <tr class="total-row">
                        <td colspan="3"><strong>CURRENT CHARGES</strong></td>
                        <td class="total-amount">{{ current_charges }}</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <!-- Payment Information -->
        <div class="payment-section">
            <h3>Payment Options</h3>
            <div class="payment-options">
                <div class="payment-option">
                    <h4>üåê Online Payment</h4>
                    <p>Visit: <strong>{{ payment_portal_url }}</strong></p>
                    <p>Account: {{ account_number }}</p>
                </div>
                <div class="payment-option">
                    <h4>üè¶ Bank Transfer</h4>
                    <p><strong>Bank:</strong> {{ bank_name }}</p>
                    <p><strong>Account:</strong> {{ bank_account }}</p>
                    <p><strong>Reference:</strong> {{ account_number }}</p>
                </div>
                <div class="payment-option">
                    <h4>üì± Mobile App</h4>
                    <p>Download our mobile app</p>
                    <p>Pay securely on-the-go</p>
                </div>
            </div>
            <div class="payment-reminder">
                <p><strong>‚ö† Payment Reminder:</strong> Please pay by {{ due_date }} to avoid late fees and service interruption.</p>
                <p><strong>Autopay:</strong> Set up automatic payments to never miss a due date!</p>
            </div>
        </div>

        <!-- Energy Saving Tips -->
        <div class="tips-section">
            <h3>üí° Energy Saving Tips</h3>
            <ul class="tips-list">
                <li>Use LED bulbs - they use 75% less energy than incandescent bulbs</li>
                <li>Adjust your thermostat - every degree can save 3-5% on cooling/heating costs</li>
                <li>Unplug devices when not in use to eliminate phantom power consumption</li>
                <li>Use ceiling fans to circulate air and reduce AC usage</li>
                <li>Schedule a free energy audit by calling {{ supplier_phone }}</li>
            </ul>
        </div>

        <!-- Footer -->
        <div class="bill-footer">
            <div class="footer-info">
                <p><strong>Customer Service:</strong> {{ supplier_phone }} (24/7)</p>
                <p><strong>Emergency/Outage:</strong> {{ emergency_number }}</p>
                <p><strong>Email:</strong> {{ supplier_email }}</p>
            </div>
            <div class="footer-legal">
                <p class="terms-conditions">{{ terms_conditions }}</p>
                <p class="privacy-notice">Your privacy is important to us. We never share your information.</p>
            </div>
        </div>
    </div>
</body>
</html>

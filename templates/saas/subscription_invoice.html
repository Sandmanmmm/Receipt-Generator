<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SaaS Subscription Invoice</title>
    <link rel="stylesheet" href="../css/saas_invoice.css">
</head>
<body>
    <div class="invoice-container">
        <!-- Header -->
        <div class="invoice-header">
            <div class="company-info">
                <h1 class="company-name">{{ supplier_name }}</h1>
                <p class="company-address">{{ supplier_address }}</p>
                <p class="company-contact">{{ supplier_email }} | {{ supplier_phone }}</p>
            </div>
            <div class="invoice-meta">
                <h2 class="doc-type">SUBSCRIPTION INVOICE</h2>
                <p><strong>Invoice Number:</strong> {{ invoice_number }}</p>
                <p><strong>Invoice Date:</strong> {{ invoice_date }}</p>
                <p><strong>Due Date:</strong> {{ due_date }}</p>
            </div>
        </div>

        <!-- Bill To -->
        <div class="bill-to-section">
            <h3>Bill To:</h3>
            <p class="buyer-name">{{ buyer_name }}</p>
            <p class="buyer-address">{{ buyer_address }}</p>
            <p class="buyer-contact">{{ buyer_email }}</p>
        </div>

        <!-- Subscription Details -->
        <div class="subscription-section">
            <h3>Subscription Details</h3>
            <div class="subscription-info">
                <div class="info-row">
                    <span class="label">Subscription ID:</span>
                    <span class="value subscription-id">{{ subscription_id }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Plan Name:</span>
                    <span class="value plan-name">{{ plan_name }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Billing Period:</span>
                    <span class="value billing-period">{{ billing_period_start }} - {{ billing_period_end }}</span>
                </div>
                <div class="info-row">
                    <span class="label">Service Period:</span>
                    <span class="value service-period">{{ service_period_start }} - {{ service_period_end }}</span>
                </div>
                <div class="info-row">
                    <span class="label">License Count:</span>
                    <span class="value license-count">{{ license_count }} users</span>
                </div>
            </div>
        </div>

        <!-- Line Items -->
        <div class="line-items-section">
            <table class="items-table">
                <thead>
                    <tr>
                        <th>Description</th>
                        <th>Period</th>
                        <th>Quantity</th>
                        <th>Unit Price</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Recurring Subscription -->
                    <tr class="item-row">
                        <td class="item-description">{{ plan_name }} - Monthly Subscription</td>
                        <td class="service-period">{{ billing_period_start }} - {{ billing_period_end }}</td>
                        <td class="quantity">{{ license_count }}</td>
                        <td class="unit-price">{{ recurring_unit_price }}</td>
                        <td class="line-total">{{ recurring_amount }}</td>
                    </tr>
                    
                    <!-- Usage Charges (if applicable) -->
                    {% if usage_charge > 0 %}
                    <tr class="item-row">
                        <td class="item-description">Usage Charges ({{ usage_type }})</td>
                        <td class="service-period">{{ billing_period_start }} - {{ billing_period_end }}</td>
                        <td class="quantity">{{ usage_quantity }}</td>
                        <td class="unit-price">{{ usage_unit_price }}</td>
                        <td class="line-total usage-charge">{{ usage_charge }}</td>
                    </tr>
                    {% endif %}
                    
                    <!-- Proration (if applicable) -->
                    {% if proration_amount != 0 %}
                    <tr class="item-row">
                        <td class="item-description">Proration Adjustment</td>
                        <td class="service-period">{{ proration_period }}</td>
                        <td class="quantity">1</td>
                        <td class="unit-price">{{ proration_amount }}</td>
                        <td class="line-total proration">{{ proration_amount }}</td>
                    </tr>
                    {% endif %}
                    
                    <!-- Previous Balance (if applicable) -->
                    {% if previous_balance > 0 %}
                    <tr class="item-row balance-row">
                        <td class="item-description">Previous Balance</td>
                        <td colspan="3"></td>
                        <td class="line-total previous-balance">{{ previous_balance }}</td>
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>

        <!-- Totals -->
        <div class="totals-section">
            <div class="totals-grid">
                <div class="total-row">
                    <span class="total-label">Subtotal:</span>
                    <span class="total-value subtotal">{{ subtotal }}</span>
                </div>
                <div class="total-row">
                    <span class="total-label">Discount ({{ discount_percent }}%):</span>
                    <span class="total-value discount">-{{ discount_amount }}</span>
                </div>
                <div class="total-row">
                    <span class="total-label">Tax ({{ tax_rate }}%):</span>
                    <span class="total-value tax">{{ tax_amount }}</span>
                </div>
                <div class="total-row grand-total">
                    <span class="total-label">Total Amount:</span>
                    <span class="total-value total-amount">{{ total_amount }}</span>
                </div>
                <div class="total-row">
                    <span class="total-label">Amount Due:</span>
                    <span class="total-value amount-due">{{ amount_due }}</span>
                </div>
            </div>
        </div>

        <!-- Payment Information -->
        <div class="payment-section">
            <h3>Payment Information</h3>
            <div class="payment-info">
                <p><strong>Payment Method:</strong> {{ payment_method }}</p>
                <p><strong>Payment Terms:</strong> {{ payment_terms }}</p>
                {% if invoice_status == "PAID" %}
                <p class="payment-status paid"><strong>Status:</strong> PAID</p>
                {% else %}
                <p class="payment-status unpaid"><strong>Status:</strong> UNPAID</p>
                {% endif %}
            </div>
            
            <!-- Bank Details -->
            <div class="bank-details">
                <h4>Bank Transfer Details:</h4>
                <p><strong>Account Holder:</strong> {{ account_holder }}</p>
                <p><strong>Bank Name:</strong> {{ bank_name }}</p>
                <p><strong>IBAN:</strong> {{ iban }}</p>
                <p><strong>SWIFT/BIC:</strong> {{ swift_code }}</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="invoice-footer">
            <div class="footer-section">
                <h4>Next Billing</h4>
                <p>Your next invoice will be generated on <strong>{{ next_billing_date }}</strong></p>
                <p>Subscription renews automatically unless cancelled</p>
            </div>
            
            <div class="footer-section">
                <h4>Terms & Conditions</h4>
                <p class="terms-conditions">{{ terms_conditions }}</p>
            </div>
            
            <div class="footer-section">
                <p class="notes">{{ notes }}</p>
            </div>
        </div>
    </div>
</body>
</html>

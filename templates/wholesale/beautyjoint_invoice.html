<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beauty Joint Invoice</title>
    <link rel="stylesheet" href="../css/beautyjoint_invoice.css">
</head>
<body>
    <div class="invoice-page">
        {% if _is_first_page|default(true) %}
        <!-- First Page Header -->
        <div class="header">
            <!-- Logo and Invoice Title -->
            <table class="header-table">
                <tr>
                    <td class="logo-cell">
                        <div class="bj-logo">
                            <span class="logo-icon">&#9670;</span>
                            <span class="logo-text">Beauty<span class="logo-joint">Joint</span></span>
                        </div>
                        <div class="tagline">Your Beauty Wholesale Partner</div>
                    </td>
                    <td class="invoice-title-cell">
                        <div class="invoice-title">INVOICE</div>
                        <div class="invoice-type">{{ invoice_type|default('Wholesale Order') }}</div>
                    </td>
                </tr>
            </table>

            <!-- Invoice Details Bar -->
            <table class="details-bar">
                <tr>
                    <td class="detail-item">
                        <div class="detail-label">Invoice #</div>
                        <div class="detail-value">{{ invoice_number }}</div>
                    </td>
                    <td class="detail-item">
                        <div class="detail-label">Order #</div>
                        <div class="detail-value">{{ order_number }}</div>
                    </td>
                    <td class="detail-item">
                        <div class="detail-label">Invoice Date</div>
                        <div class="detail-value">{{ invoice_date }}</div>
                    </td>
                    <td class="detail-item">
                        <div class="detail-label">Payment Terms</div>
                        <div class="detail-value">{{ payment_terms|default('Due on Receipt') }}</div>
                    </td>
                    <td class="detail-item last">
                        <div class="detail-label">Account Tier</div>
                        <div class="detail-value tier-badge">{{ account_tier|default('Wholesale') }}</div>
                    </td>
                </tr>
            </table>
        </div>

        <!-- Addresses Section -->
        <table class="addresses-section">
            <tr>
                <td class="address-block sold-by">
                    <div class="address-header">
                        <span class="header-icon">&#9670;</span>
                        <span class="header-text">Sold By</span>
                    </div>
                    <div class="address-content">
                        <div class="company-name">{{ supplier_name|default('BeautyJoint.Com, Inc.') }}</div>
                        <div class="address-line">{{ supplier_address|default('12345 Wholesale Blvd') }}</div>
                        <div class="address-line">{{ supplier_city|default('Los Angeles') }}, {{ supplier_state|default('CA') }} {{ supplier_zip|default('90001') }}</div>
                        <div class="address-line">United States</div>
                        <div class="contact-line">
                            <span class="contact-label">Email:</span> {{ supplier_email|default('wholesale@beautyjoint.com') }}
                        </div>
                        <div class="contact-line">
                            <span class="contact-label">Web:</span> {{ supplier_website|default('beautyjoint.com') }}
                        </div>
                    </div>
                </td>
                <td class="address-block bill-to">
                    <div class="address-header">
                        <span class="header-icon">&#9670;</span>
                        <span class="header-text">Bill To</span>
                    </div>
                    <div class="address-content">
                        <div class="company-name">{{ buyer_company|default(buyer_name) }}</div>
                        {% if buyer_contact %}
                        <div class="address-line">Attn: {{ buyer_contact }}</div>
                        {% endif %}
                        <div class="address-line">{{ buyer_address }}</div>
                        <div class="address-line">{{ buyer_city }}, {{ buyer_state }} {{ buyer_zip }}</div>
                        {% if buyer_country %}
                        <div class="address-line">{{ buyer_country }}</div>
                        {% endif %}
                        {% if buyer_email %}
                        <div class="contact-line">
                            <span class="contact-label">Email:</span> {{ buyer_email }}
                        </div>
                        {% endif %}
                        {% if buyer_tax_id %}
                        <div class="contact-line">
                            <span class="contact-label">Tax ID:</span> {{ buyer_tax_id }}
                        </div>
                        {% endif %}
                    </div>
                </td>
                <td class="address-block ship-to">
                    <div class="address-header">
                        <span class="header-icon">&#9670;</span>
                        <span class="header-text">Ship To</span>
                    </div>
                    <div class="address-content">
                        <div class="company-name">{{ shipping_name|default(buyer_company)|default(buyer_name) }}</div>
                        <div class="address-line">{{ shipping_address|default(buyer_address) }}</div>
                        <div class="address-line">{{ shipping_city|default(buyer_city) }}, {{ shipping_state|default(buyer_state) }} {{ shipping_zip|default(buyer_zip) }}</div>
                        {% if shipping_country|default(buyer_country) %}
                        <div class="address-line">{{ shipping_country|default(buyer_country) }}</div>
                        {% endif %}
                        {% if shipping_method %}
                        <div class="shipping-method">
                            <span class="method-label">Method:</span> {{ shipping_method }}
                        </div>
                        {% endif %}
                    </div>
                </td>
            </tr>
        </table>

        <!-- Order Info Banner -->
        {% if brand_filter or category %}
        <div class="order-banner">
            {% if brand_filter %}
            <span class="banner-item"><strong>Brand:</strong> {{ brand_filter }}</span>
            {% endif %}
            {% if category %}
            <span class="banner-item"><strong>Category:</strong> {{ category }}</span>
            {% endif %}
        </div>
        {% endif %}
        {% endif %}

        <!-- Continuation Header -->
        {% if not _is_first_page|default(true) %}
        <div class="continuation-header">
            <div class="cont-left">
                <span class="cont-logo">&#9670;</span>
                <span class="cont-company">{{ supplier_name|default('BeautyJoint') }}</span>
            </div>
            <div class="cont-center">
                <span class="cont-invoice">Invoice: {{ invoice_number }}</span>
            </div>
            <div class="cont-right">
                <span class="cont-page">Page {{ _page_number }} of {{ _total_pages }}</span>
            </div>
        </div>
        {% endif %}

        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-item">Item / SKU</th>
                    <th class="col-brand">Brand</th>
                    <th class="col-desc">Description</th>
                    <th class="col-upc">UPC</th>
                    <th class="col-qty">Qty</th>
                    <th class="col-price">Unit Price</th>
                    <th class="col-total">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr class="item-row {% if loop.index % 2 == 0 %}even{% else %}odd{% endif %}">
                    <td class="col-item">
                        <div class="item-sku">{{ item.sku|default(item.item_code) }}</div>
                    </td>
                    <td class="col-brand">{{ item.brand|default('Beauty Joint') }}</td>
                    <td class="col-desc">
                        <div class="item-name">{{ item.name }}</div>
                        {% if item.variant %}
                        <div class="item-variant">{{ item.variant }}</div>
                        {% endif %}
                        {% if item.style %}
                        <div class="item-style">Style: {{ item.style }}</div>
                        {% endif %}
                        {% if item.category %}
                        <div class="item-category">{{ item.category }}</div>
                        {% endif %}
                        {% if item.shade %}
                        <div class="item-shade">Shade: {{ item.shade }}</div>
                        {% endif %}
                    </td>
                    <td class="col-upc">{{ item.upc|default('—') }}</td>
                    <td class="col-qty">{{ item.quantity }}</td>
                    <td class="col-price">${{ "%.2f"|format(item.unit_price_raw|default(0)) }}</td>
                    <td class="col-total">${{ "%.2f"|format(item.total_raw|default(0)) }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Page Break Indicator for Multipage -->
        {% if not _is_last_page|default(true) %}
        <div class="page-break-notice">
            <span class="notice-text">— Continued on next page —</span>
        </div>
        {% endif %}

        <!-- Totals Section (Last Page Only) -->
        {% if _is_last_page|default(true) %}
        <table class="totals-section">
            <tr>
                <td class="notes-column">
                    {% if notes %}
                    <div class="notes-box">
                        <div class="notes-header">Order Notes</div>
                        <div class="notes-content">{{ notes }}</div>
                    </div>
                    {% endif %}

                    <div class="wholesale-notice">
                        <div class="notice-icon">[i]</div>
                        <div class="notice-text">
                            <strong>Wholesale Terms:</strong> All sales are final. No returns or exchanges. 
                            California orders subject to applicable sales tax.
                        </div>
                    </div>
                </td>
                <td class="totals-column">
                    <table class="totals-table">
                        <tr>
                            <td class="total-label">Subtotal:</td>
                            <td class="total-value">${{ "%.2f"|format(subtotal|to_float) }}</td>
                        </tr>
                        {% if discount_amount and (discount_amount|to_float) > 0 %}
                        <tr class="discount-row">
                            <td class="total-label">Wholesale Discount ({{ discount_percent|default('30%') }}):</td>
                            <td class="total-value discount">-${{ "%.2f"|format(discount_amount|to_float) }}</td>
                        </tr>
                        {% endif %}
                        <tr>
                            <td class="total-label">Shipping ({{ shipping_method|default('USPS') }}):</td>
                            <td class="total-value">${{ "%.2f"|format(shipping_amount|default(0)|to_float) }}</td>
                        </tr>
                        {% if insurance_amount %}
                        <tr>
                            <td class="total-label">Shipping Insurance:</td>
                            <td class="total-value">${{ insurance_amount }}</td>
                        </tr>
                        {% endif %}
                        {% if tax_amount and (tax_amount|to_float) > 0 %}
                        <tr>
                            <td class="total-label">CA Sales Tax ({{ tax_rate|default('9.5%') }}):</td>
                            <td class="total-value">${{ "%.2f"|format(tax_amount|to_float) }}</td>
                        </tr>
                        {% endif %}
                        <tr class="grand-total">
                            <td class="total-label">Order Total:</td>
                            <td class="total-value">${{ "%.2f"|format(total_amount|to_float) }}</td>
                        </tr>
                    </table>

                    {% if amount_paid %}
                    <table class="payment-table">
                        <tr>
                            <td class="payment-label">Amount Paid:</td>
                            <td class="payment-value">${{ amount_paid }}</td>
                        </tr>
                        <tr class="balance-row">
                            <td class="payment-label">Balance Due:</td>
                            <td class="payment-value">${{ balance_due|default('0.00') }}</td>
                        </tr>
                    </table>
                    {% endif %}
                </td>
            </tr>
        </table>

        <!-- Payment Information -->
        <div class="payment-info">
            <div class="payment-header">Payment Information</div>
            <table class="payment-methods">
                <tr>
                    <td class="method-block">
                        <div class="method-icon">[CARD]</div>
                        <div class="method-name">Credit/Debit</div>
                        <div class="method-detail">Visa, MC, Amex, Discover</div>
                    </td>
                    <td class="method-block">
                        <div class="method-icon">[PP]</div>
                        <div class="method-name">PayPal</div>
                        <div class="method-detail">{{ payment_email|default(supplier_email)|default('payments@beautyjoint.com') }}</div>
                    </td>
                    <td class="method-block">
                        <div class="method-icon">[BANK]</div>
                        <div class="method-name">Wire Transfer</div>
                        <div class="method-detail">Contact for details</div>
                    </td>
                    <td class="method-block">
                        <div class="method-icon">[$]</div>
                        <div class="method-name">Money Order</div>
                        <div class="method-detail">Western Union / MoneyGram</div>
                    </td>
                </tr>
            </table>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-left">
                <span class="footer-logo">&#9670;</span>
                <span class="footer-text">{{ supplier_name|default('BeautyJoint.Com, Inc.') }} | {{ supplier_city|default('Los Angeles') }}, {{ supplier_state|default('CA') }}</span>
            </div>
            <div class="footer-center">
                <span class="footer-contact">{{ supplier_email|default('customerservice@beautyjoint.com') }}</span>
            </div>
            <div class="footer-right">
                <span class="page-info">Page {{ _page_number|default(1) }} of {{ _total_pages|default(1) }}</span>
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>
